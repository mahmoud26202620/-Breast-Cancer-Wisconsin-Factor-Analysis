# Breast Cancer Wisconsin: Factor Analysis

# Introduction

According to the American Cancer Society website, In an FNA, the doctor uses a very thin, hollow needle attached to a syringe to withdraw (aspirate) a small amount of breast tissue or fluid from a suspicious area.

FNA is most often done if the suspicious area is likely to be a fluid-filled sac (a cyst). By removing fluid, the FNA can often help relieve pain from the cyst. FNA can also be helpful if the doctor is unsure if an area seen on an imaging test is a small cyst or a solid mass.

If the area to be biopsied can be felt, the needle can be guided into it while the doctor is feeling it. 

If the lump can't be felt easily, the doctor might watch the needle on an ultrasound screen as it moves towards and into the area. This is called an ultrasound-guided FNA.

If an FNA is done to test a suspicious area in the breast, the sample is then checked for cancer cells. One drawback of FNA is that it only removes a small amount of tissue and cells, so the sample usually needs to be checked right away under a microscope to make sure more samples don’t need to be taken[^1].

[^1]: [Fine Needle Aspiration (FNA) of the Breast](https://www.cancer.org/cancer/breast-cancer/screening-tests-and-early-detection/breast-biopsy/fine-needle-aspiration-biopsy-of-the-breast.html#:~:text=During%20a%20fine%20needle%20aspiration,needle%20biopsy%20is%20often%20preferred)

![image](https://user-images.githubusercontent.com/41892582/231312725-e21a384d-b0be-4d07-81ca-c756e446d7f6.png)

And according to the paper published at the National Library of Medicine website, All breast lesions are not malignant, and all the benign lesions do not progress to cancer. However, the accuracy of the diagnosis can be increased by a combination of preoperative tests (like physical examination, mammography, fine-needle aspiration cytology, and core needle biopsy). These modalities are more accurate, reliable, and acceptable when compared with a single adopted diagnostic procedure, despite having their own technical limitations[^2].

[^2]: [Use of Fine-Needle Aspiration in the Evaluation of Breast Lumps](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3135154/#B4)

Our goal is to use the Diagnostic Wisconsin Breast Cancer Database[^3]  to predict the diagnosis and determine if it is malignant or benign.

[^3]: [Breast Cancer Wisconsin (Diagnostic) Data Set](https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+%28Diagnostic%29)

Data set information and attribute information from the previous source

**Data Set Information:**

Features are computed from a digitized image of a fine needle aspirate (FNA) of a breast mass. They describe characteristics of the cell nuclei present in the image. A few of the images can be found at [Web Link]

Separating plane described above was obtained using Multisurface Method-Tree (MSM-T) [K. P. Bennett, "Decision Tree Construction Via Linear Programming." Proceedings of the 4th Midwest Artificial Intelligence and Cognitive Science Society, pp. 97-101, 1992], a classification method which uses linear programming to construct a decision tree. Relevant features were selected using an exhaustive search in the space of 1-4 features and 1-3 separating planes.

The actual linear program used to obtain the separating plane in the 3-dimensional space is that described in: [K. P. Bennett and O. L. Mangasarian: "Robust Linear Programming Discrimination of Two Linearly Inseparable Sets", Optimization Methods and Software 1, 1992, 23-34].

This database is also available through the UW CS ftp server:
ftp ftp.cs.wisc.edu
cd math-prog/cpo-dataset/machine-learn/WDBC/


**Attribute Information:**

1) ID number
2) Diagnosis (M = malignant, B = benign)

3-32)

Ten real-valued features are computed for each cell nucleus:

a) radius (mean of distances from center to points on the perimeter)

b) texture (standard deviation of gray-scale values)

c) perimeter

d) area

e) smoothness (local variation in radius lengths)

f) compactness (perimeter^2 / area - 1.0)

g) concavity (severity of concave portions of the contour)

h) concave points (number of concave portions of the contour)

i) symmetry

j) fractal dimension ("coastline approximation" - 1)


**Loading libraries**

Firstly I will start by loading some packages that I will use during the analysis

~~~
library(tidyverse)
library(caret)
library(splines)
library(rpart)
library(rpart.plot)
library(ggcorrplot)
library(corrplot)
library(ppcor)
library(EFAtools)
library(psych)
library(REdaS)
~~~

**Getting the data**

~~~
data<-read.csv("Breast Cancer.csv")
~~~

# Exploration of the data 

The structure of the data
~~~
##the structure of the data
str(data)
~~~

~~~
'data.frame':	569 obs. of  33 variables:
 $ id                     : int  842302 842517 84300903 84348301 84358402 843786 844359 84458202 844981 84501001 ...
 $ diagnosis              : chr  "M" "M" "M" "M" ...
 $ radius_mean            : num  18 20.6 19.7 11.4 20.3 ...
 $ texture_mean           : num  10.4 17.8 21.2 20.4 14.3 ...
 $ perimeter_mean         : num  122.8 132.9 130 77.6 135.1 ...
 $ area_mean              : num  1001 1326 1203 386 1297 ...
 $ smoothness_mean        : num  0.1184 0.0847 0.1096 0.1425 0.1003 ...
 $ compactness_mean       : num  0.2776 0.0786 0.1599 0.2839 0.1328 ...
 $ concavity_mean         : num  0.3001 0.0869 0.1974 0.2414 0.198 ...
 $ concave.points_mean    : num  0.1471 0.0702 0.1279 0.1052 0.1043 ...
 $ symmetry_mean          : num  0.242 0.181 0.207 0.26 0.181 ...
 $ fractal_dimension_mean : num  0.0787 0.0567 0.06 0.0974 0.0588 ...
 $ radius_se              : num  1.095 0.543 0.746 0.496 0.757 ...
 $ texture_se             : num  0.905 0.734 0.787 1.156 0.781 ...
 $ perimeter_se           : num  8.59 3.4 4.58 3.44 5.44 ...
 $ area_se                : num  153.4 74.1 94 27.2 94.4 ...
 $ smoothness_se          : num  0.0064 0.00522 0.00615 0.00911 0.01149 ...
 $ compactness_se         : num  0.049 0.0131 0.0401 0.0746 0.0246 ...
 $ concavity_se           : num  0.0537 0.0186 0.0383 0.0566 0.0569 ...
 $ concave.points_se      : num  0.0159 0.0134 0.0206 0.0187 0.0188 ...
 $ symmetry_se            : num  0.03 0.0139 0.0225 0.0596 0.0176 ...
 $ fractal_dimension_se   : num  0.00619 0.00353 0.00457 0.00921 0.00511 ...
 $ radius_worst           : num  25.4 25 23.6 14.9 22.5 ...
 $ texture_worst          : num  17.3 23.4 25.5 26.5 16.7 ...
 $ perimeter_worst        : num  184.6 158.8 152.5 98.9 152.2 ...
 $ area_worst             : num  2019 1956 1709 568 1575 ...
 $ smoothness_worst       : num  0.162 0.124 0.144 0.21 0.137 ...
 $ compactness_worst      : num  0.666 0.187 0.424 0.866 0.205 ...
 $ concavity_worst        : num  0.712 0.242 0.45 0.687 0.4 ...
 $ concave.points_worst   : num  0.265 0.186 0.243 0.258 0.163 ...
 $ symmetry_worst         : num  0.46 0.275 0.361 0.664 0.236 ...
 $ fractal_dimension_worst: num  0.1189 0.089 0.0876 0.173 0.0768 ...
 $ X  
~~~

Drop out the id variable and the X variable, and convert the elements of the diagnosis variable to 0 if it's malignant and 1 if it's benign.

~~~
##drop out the id variable and the X variable
data<-dplyr::select(data,-X,-id)
##convert the elements of the diagnosis variable to 0 if it's malignant and 1 if it's benign
data$diagnosis<-ifelse(data$diagnosis=="M",0,1)
~~~

summary of the data

~~~
##summary of the data
summary(data)
~~~

~~~
   diagnosis       radius_mean      texture_mean   perimeter_mean  
 Min.   :0.0000   Min.   : 6.981   Min.   : 9.71   Min.   : 43.79  
 1st Qu.:0.0000   1st Qu.:11.700   1st Qu.:16.17   1st Qu.: 75.17  
 Median :1.0000   Median :13.370   Median :18.84   Median : 86.24  
 Mean   :0.6274   Mean   :14.127   Mean   :19.29   Mean   : 91.97  
 3rd Qu.:1.0000   3rd Qu.:15.780   3rd Qu.:21.80   3rd Qu.:104.10  
 Max.   :1.0000   Max.   :28.110   Max.   :39.28   Max.   :188.50  
   area_mean      smoothness_mean   compactness_mean  concavity_mean   
 Min.   : 143.5   Min.   :0.05263   Min.   :0.01938   Min.   :0.00000  
 1st Qu.: 420.3   1st Qu.:0.08637   1st Qu.:0.06492   1st Qu.:0.02956  
 Median : 551.1   Median :0.09587   Median :0.09263   Median :0.06154  
 Mean   : 654.9   Mean   :0.09636   Mean   :0.10434   Mean   :0.08880  
 3rd Qu.: 782.7   3rd Qu.:0.10530   3rd Qu.:0.13040   3rd Qu.:0.13070  
 Max.   :2501.0   Max.   :0.16340   Max.   :0.34540   Max.   :0.42680  
 concave.points_mean symmetry_mean    fractal_dimension_mean   radius_se     
 Min.   :0.00000     Min.   :0.1060   Min.   :0.04996        Min.   :0.1115  
 1st Qu.:0.02031     1st Qu.:0.1619   1st Qu.:0.05770        1st Qu.:0.2324  
 Median :0.03350     Median :0.1792   Median :0.06154        Median :0.3242  
 Mean   :0.04892     Mean   :0.1812   Mean   :0.06280        Mean   :0.4052  
 3rd Qu.:0.07400     3rd Qu.:0.1957   3rd Qu.:0.06612        3rd Qu.:0.4789  
 Max.   :0.20120     Max.   :0.3040   Max.   :0.09744        Max.   :2.8730  
   texture_se      perimeter_se       area_se        smoothness_se     
 Min.   :0.3602   Min.   : 0.757   Min.   :  6.802   Min.   :0.001713  
 1st Qu.:0.8339   1st Qu.: 1.606   1st Qu.: 17.850   1st Qu.:0.005169  
 Median :1.1080   Median : 2.287   Median : 24.530   Median :0.006380  
 Mean   :1.2169   Mean   : 2.866   Mean   : 40.337   Mean   :0.007041  
 3rd Qu.:1.4740   3rd Qu.: 3.357   3rd Qu.: 45.190   3rd Qu.:0.008146  
 Max.   :4.8850   Max.   :21.980   Max.   :542.200   Max.   :0.031130  
 compactness_se      concavity_se     concave.points_se   symmetry_se      
 Min.   :0.002252   Min.   :0.00000   Min.   :0.000000   Min.   :0.007882  
 1st Qu.:0.013080   1st Qu.:0.01509   1st Qu.:0.007638   1st Qu.:0.015160  
 Median :0.020450   Median :0.02589   Median :0.010930   Median :0.018730  
 Mean   :0.025478   Mean   :0.03189   Mean   :0.011796   Mean   :0.020542  
 3rd Qu.:0.032450   3rd Qu.:0.04205   3rd Qu.:0.014710   3rd Qu.:0.023480  
 Max.   :0.135400   Max.   :0.39600   Max.   :0.052790   Max.   :0.078950  
 fractal_dimension_se  radius_worst   texture_worst   perimeter_worst 
 Min.   :0.0008948    Min.   : 7.93   Min.   :12.02   Min.   : 50.41  
 1st Qu.:0.0022480    1st Qu.:13.01   1st Qu.:21.08   1st Qu.: 84.11  
 Median :0.0031870    Median :14.97   Median :25.41   Median : 97.66  
 Mean   :0.0037949    Mean   :16.27   Mean   :25.68   Mean   :107.26  
 3rd Qu.:0.0045580    3rd Qu.:18.79   3rd Qu.:29.72   3rd Qu.:125.40  
 Max.   :0.0298400    Max.   :36.04   Max.   :49.54   Max.   :251.20  
   area_worst     smoothness_worst  compactness_worst concavity_worst 
 Min.   : 185.2   Min.   :0.07117   Min.   :0.02729   Min.   :0.0000  
 1st Qu.: 515.3   1st Qu.:0.11660   1st Qu.:0.14720   1st Qu.:0.1145  
 Median : 686.5   Median :0.13130   Median :0.21190   Median :0.2267  
 Mean   : 880.6   Mean   :0.13237   Mean   :0.25427   Mean   :0.2722  
 3rd Qu.:1084.0   3rd Qu.:0.14600   3rd Qu.:0.33910   3rd Qu.:0.3829  
 Max.   :4254.0   Max.   :0.22260   Max.   :1.05800   Max.   :1.2520  
 concave.points_worst symmetry_worst   fractal_dimension_worst
 Min.   :0.00000      Min.   :0.1565   Min.   :0.05504        
 1st Qu.:0.06493      1st Qu.:0.2504   1st Qu.:0.07146        
 Median :0.09993      Median :0.2822   Median :0.08004        
 Mean   :0.11461      Mean   :0.2901   Mean   :0.08395        
 3rd Qu.:0.16140      3rd Qu.:0.3179   3rd Qu.:0.09208        
 Max.   :0.29100      Max.   :0.6638   Max.   :0.20750  
~~~

**Checking for NAs**

~~~
colSums(is.na(data))
~~~

~~~
              diagnosis             radius_mean            texture_mean 
                      0                       0                       0 
         perimeter_mean               area_mean         smoothness_mean 
                      0                       0                       0 
       compactness_mean          concavity_mean     concave.points_mean 
                      0                       0                       0 
          symmetry_mean  fractal_dimension_mean               radius_se 
                      0                       0                       0 
             texture_se            perimeter_se                 area_se 
                      0                       0                       0 
          smoothness_se          compactness_se            concavity_se 
                      0                       0                       0 
      concave.points_se             symmetry_se    fractal_dimension_se 
                      0                       0                       0 
           radius_worst           texture_worst         perimeter_worst 
                      0                       0                       0 
             area_worst        smoothness_worst       compactness_worst 
                      0                       0                       0 
        concavity_worst    concave.points_worst          symmetry_worst 
                      0                       0                       0 
fractal_dimension_worst 
                      0 
~~~

data is clean and ready for analys

**Correlation analysis**

Let's see the correlation matrix of the dataset

~~~
##correlation matrix
cor(data)
~~~

~~~
                           diagnosis  radius_mean texture_mean perimeter_mean    area_mean smoothness_mean compactness_mean concavity_mean
diagnosis                1.000000000 -0.730028511 -0.415185300   -0.742635530 -0.708983837     -0.35855997      -0.59653368    -0.69635971
radius_mean             -0.730028511  1.000000000  0.323781891    0.997855281  0.987357170      0.17058119       0.50612358     0.67676355
texture_mean            -0.415185300  0.323781891  1.000000000    0.329533059  0.321085696     -0.02338852       0.23670222     0.30241783
perimeter_mean          -0.742635530  0.997855281  0.329533059    1.000000000  0.986506804      0.20727816       0.55693621     0.71613565
area_mean               -0.708983837  0.987357170  0.321085696    0.986506804  1.000000000      0.17702838       0.49850168     0.68598283
smoothness_mean         -0.358559965  0.170581187 -0.023388516    0.207278164  0.177028377      1.00000000       0.65912322     0.52198377
compactness_mean        -0.596533678  0.506123578  0.236702222    0.556936211  0.498501682      0.65912322       1.00000000     0.88312067
concavity_mean          -0.696359707  0.676763550  0.302417828    0.716135650  0.685982829      0.52198377       0.88312067     1.00000000
concave.points_mean     -0.776613840  0.822528522  0.293464051    0.850977041  0.823268869      0.55369517       0.83113504     0.92139103
symmetry_mean           -0.330498554  0.147741242  0.071400980    0.183027212  0.151293079      0.55777479       0.60264105     0.50066662
fractal_dimension_mean   0.012837603 -0.311630826 -0.076437183   -0.261476908 -0.283109812      0.58479200       0.56536866     0.33678336
radius_se               -0.567133821  0.679090388  0.275868676    0.691765014  0.732562227      0.30146710       0.49747345     0.63192482
texture_se               0.008303333 -0.097317443  0.386357623   -0.086761078 -0.066280214      0.06840645       0.04620483     0.07621835
perimeter_se            -0.556140703  0.674171616  0.281673115    0.693134890  0.726628328      0.29609193       0.54890526     0.66039079
area_se                 -0.548235940  0.735863663  0.259844987    0.744982694  0.800085921      0.24655243       0.45565285     0.61742681
smoothness_se            0.067016011 -0.222600125  0.006613777   -0.202694026 -0.166776667      0.33237544       0.13529927     0.09856375
compactness_se          -0.292999244  0.205999980  0.191974611    0.250743681  0.212582551      0.31894330       0.73872179     0.67027882
concavity_se            -0.253729766  0.194203623  0.143293077    0.228082345  0.207660060      0.24839568       0.57051687     0.69127021
concave.points_se       -0.408042333  0.376168956  0.163851025    0.407216916  0.372320282      0.38067569       0.64226185     0.68325992
symmetry_se              0.006521756 -0.104320881  0.009127168   -0.081629327 -0.072496588      0.20077438       0.22997659     0.17800921
fractal_dimension_se    -0.077972417 -0.042641269  0.054457520   -0.005523391 -0.019886963      0.28360670       0.50731813     0.44930075
radius_worst            -0.776453779  0.969538973  0.352572947    0.969476363  0.962746086      0.21312014       0.53531540     0.68823641
texture_worst           -0.456902821  0.297007644  0.912044589    0.303038372  0.287488627      0.03607180       0.24813283     0.29987889
perimeter_worst         -0.782914137  0.965136514  0.358039575    0.970386887  0.959119574      0.23885263       0.59021043     0.72956492
area_worst              -0.733825035  0.941082460  0.343545947    0.941549808  0.959213326      0.20671836       0.50960381     0.67598723
smoothness_worst        -0.421464861  0.119616140  0.077503359    0.150549404  0.123522939      0.80532420       0.56554117     0.44882204
compactness_worst       -0.590998238  0.413462823  0.277829592    0.455774228  0.390410309      0.47246844       0.86580904     0.75496802
concavity_worst         -0.659610210  0.526911462  0.301025224    0.563879263  0.512605920      0.43492571       0.81627525     0.88410264
concave.points_worst    -0.793566017  0.744214198  0.295315843    0.771240789  0.722016626      0.50305335       0.81557322     0.86132303
symmetry_worst          -0.416294311  0.163953335  0.105007910    0.189115040  0.143569914      0.39430948       0.51022343     0.40946413
fractal_dimension_worst -0.323872189  0.007065886  0.119205351    0.051018530  0.003737597      0.49931637       0.68738232     0.51492989
                        concave.points_mean symmetry_mean fractal_dimension_mean     radius_se   texture_se perimeter_se     area_se smoothness_se
diagnosis                       -0.77661384   -0.33049855           0.0128376027 -0.5671338208  0.008303333  -0.55614070 -0.54823594   0.067016011
radius_mean                      0.82252852    0.14774124          -0.3116308263  0.6790903880 -0.097317443   0.67417162  0.73586366  -0.222600125
texture_mean                     0.29346405    0.07140098          -0.0764371834  0.2758686762  0.386357623   0.28167311  0.25984499   0.006613777
perimeter_mean                   0.85097704    0.18302721          -0.2614769081  0.6917650135 -0.086761078   0.69313489  0.74498269  -0.202694026
area_mean                        0.82326887    0.15129308          -0.2831098117  0.7325622270 -0.066280214   0.72662833  0.80008592  -0.166776667
smoothness_mean                  0.55369517    0.55777479           0.5847920019  0.3014670983  0.068406448   0.29609193  0.24655243   0.332375443
compactness_mean                 0.83113504    0.60264105           0.5653686634  0.4974734461  0.046204831   0.54890526  0.45565285   0.135299268
concavity_mean                   0.92139103    0.50066662           0.3367833594  0.6319248221  0.076218348   0.66039079  0.61742681   0.098563746
concave.points_mean              1.00000000    0.46249739           0.1669173832  0.6980498336  0.021479582   0.71064987  0.69029854   0.027653308
symmetry_mean                    0.46249739    1.00000000           0.4799213301  0.3033792632  0.128052926   0.31389276  0.22397022   0.187321165
fractal_dimension_mean           0.16691738    0.47992133           1.0000000000  0.0001109951  0.164173966   0.03982993 -0.09017025   0.401964425
radius_se                        0.69804983    0.30337926           0.0001109951  1.0000000000  0.213247337   0.97279368  0.95183011   0.164514220
texture_se                       0.02147958    0.12805293           0.1641739659  0.2132473373  1.000000000   0.22317073  0.11156725   0.397242853
perimeter_se                     0.71064987    0.31389276           0.0398299316  0.9727936770  0.223170729   1.00000000  0.93765541   0.151075331
area_se                          0.69029854    0.22397022          -0.0901702475  0.9518301121  0.111567247   0.93765541  1.00000000   0.075150338
smoothness_se                    0.02765331    0.18732117           0.4019644254  0.1645142198  0.397242853   0.15107533  0.07515034   1.000000000
compactness_se                   0.49042425    0.42165915           0.5598366906  0.3560645755  0.231699699   0.41632237  0.28484006   0.336696081
concavity_se                     0.43916707    0.34262702           0.4466303217  0.3323575376  0.194998464   0.36248158  0.27089473   0.268684760
concave.points_se                0.61563413    0.39329787           0.3411980444  0.5133464414  0.230283400   0.55626408  0.41572957   0.328429499
symmetry_se                      0.09535079    0.44913654           0.3450073971  0.2405673625  0.411620680   0.26648709  0.13410898   0.413506125
fractal_dimension_se             0.25758375    0.33178615           0.6881315775  0.2277535327  0.279722748   0.24414277  0.12707090   0.427374207
radius_worst                     0.83031763    0.18572775          -0.2536914949  0.7150651951 -0.111690313   0.69720059  0.75737319  -0.230690710
texture_worst                    0.29275171    0.09065069          -0.0512692020  0.1947985568  0.409002766   0.20037085  0.19649665  -0.074742965
perimeter_worst                  0.85592313    0.21916856          -0.2051512113  0.7196838037 -0.102241922   0.72103131  0.76121264  -0.217303755
area_worst                       0.80962962    0.17719338          -0.2318544512  0.7515484761 -0.083194989   0.73071297  0.81140796  -0.182195478
smoothness_worst                 0.45275305    0.42667503           0.5049420754  0.1419185529 -0.073657659   0.13005439  0.12538943   0.314457456
compactness_worst                0.66745368    0.47320001           0.4587981567  0.2871031656 -0.092439354   0.34191945  0.28325654  -0.055558139
concavity_worst                  0.75239950    0.43372101           0.3462338763  0.3805846346 -0.068956221   0.41889882  0.38510014  -0.058298387
concave.points_worst             0.91015531    0.43029661           0.1753254492  0.5310623278 -0.119637523   0.55489723  0.53816631  -0.102006796
symmetry_worst                   0.37574415    0.69982580           0.3340186839  0.0945428304 -0.128214758   0.10993043  0.07412629  -0.107342098
fractal_dimension_worst          0.36866113    0.43841350           0.7672967792  0.0495594325 -0.045654569   0.08543257  0.01753930   0.101480315
                        compactness_se concavity_se concave.points_se  symmetry_se fractal_dimension_se radius_worst texture_worst perimeter_worst
diagnosis                   -0.2929992   -0.2537298       -0.40804233  0.006521756         -0.077972417  -0.77645378  -0.456902821    -0.782914137
radius_mean                  0.2060000    0.1942036        0.37616896 -0.104320881         -0.042641269   0.96953897   0.297007644     0.965136514
texture_mean                 0.1919746    0.1432931        0.16385103  0.009127168          0.054457520   0.35257295   0.912044589     0.358039575
perimeter_mean               0.2507437    0.2280823        0.40721692 -0.081629327         -0.005523391   0.96947636   0.303038372     0.970386887
area_mean                    0.2125826    0.2076601        0.37232028 -0.072496588         -0.019886963   0.96274609   0.287488627     0.959119574
smoothness_mean              0.3189433    0.2483957        0.38067569  0.200774376          0.283606699   0.21312014   0.036071799     0.238852626
compactness_mean             0.7387218    0.5705169        0.64226185  0.229976591          0.507318127   0.53531540   0.248132833     0.590210428
concavity_mean               0.6702788    0.6912702        0.68325992  0.178009208          0.449300749   0.68823641   0.299878889     0.729564917
concave.points_mean          0.4904242    0.4391671        0.61563413  0.095350787          0.257583746   0.83031763   0.292751713     0.855923128
symmetry_mean                0.4216591    0.3426270        0.39329787  0.449136542          0.331786146   0.18572775   0.090650688     0.219168559
fractal_dimension_mean       0.5598367    0.4466303        0.34119804  0.345007397          0.688131577  -0.25369149  -0.051269202    -0.205151211
radius_se                    0.3560646    0.3323575        0.51334644  0.240567362          0.227753533   0.71506520   0.194798557     0.719683804
texture_se                   0.2316997    0.1949985        0.23028340  0.411620680          0.279722748  -0.11169031   0.409002766    -0.102241922
perimeter_se                 0.4163224    0.3624816        0.55626408  0.266487092          0.244142773   0.69720059   0.200370854     0.721031310
area_se                      0.2848401    0.2708947        0.41572957  0.134108980          0.127070903   0.75737319   0.196496649     0.761212636
smoothness_se                0.3366961    0.2686848        0.32842950  0.413506125          0.427374207  -0.23069071  -0.074742965    -0.217303755
compactness_se               1.0000000    0.8012683        0.74408267  0.394712835          0.803268818   0.20460717   0.143002583     0.260515840
concavity_se                 0.8012683    1.0000000        0.77180399  0.309428578          0.727372184   0.18690352   0.100240984     0.226680426
concave.points_se            0.7440827    0.7718040        1.00000000  0.312780223          0.611044139   0.35812667   0.086741210     0.394999252
symmetry_se                  0.3947128    0.3094286        0.31278022  1.000000000          0.369078083  -0.12812077  -0.077473420    -0.103753044
fractal_dimension_se         0.8032688    0.7273722        0.61104414  0.369078083          1.000000000  -0.03748762  -0.003195029    -0.001000398
radius_worst                 0.2046072    0.1869035        0.35812667 -0.128120769         -0.037487618   1.00000000   0.359920754     0.993707916
texture_worst                0.1430026    0.1002410        0.08674121 -0.077473420         -0.003195029   0.35992075   1.000000000     0.365098245
perimeter_worst              0.2605158    0.2266804        0.39499925 -0.103753044         -0.001000398   0.99370792   0.365098245     1.000000000
area_worst                   0.1993713    0.1883527        0.34227116 -0.110342743         -0.022736147   0.98401456   0.345842283     0.977578091
smoothness_worst             0.2273942    0.1684813        0.21535060 -0.012661800          0.170568316   0.21657443   0.225429415     0.236774604
compactness_worst            0.6787804    0.4848578        0.45288838  0.060254879          0.390158842   0.47582004   0.360832339     0.529407690
concavity_worst              0.6391467    0.6625641        0.54959238  0.037119049          0.379974661   0.57397471   0.368365607     0.618344080
concave.points_worst         0.4832083    0.4404723        0.60244961 -0.030413396          0.215204013   0.78742385   0.359754610     0.816322102
symmetry_worst               0.2778784    0.1977878        0.14311567  0.389402485          0.111093956   0.24352920   0.233027461     0.269492769
fractal_dimension_worst      0.5909728    0.4393293        0.31065455  0.078079476          0.591328066   0.09349198   0.219122425     0.138956862
                         area_worst smoothness_worst compactness_worst concavity_worst concave.points_worst symmetry_worst fractal_dimension_worst
diagnosis               -0.73382503      -0.42146486       -0.59099824     -0.65961021           -0.7935660    -0.41629431            -0.323872189
radius_mean              0.94108246       0.11961614        0.41346282      0.52691146            0.7442142     0.16395333             0.007065886
texture_mean             0.34354595       0.07750336        0.27782959      0.30102522            0.2953158     0.10500791             0.119205351
perimeter_mean           0.94154981       0.15054940        0.45577423      0.56387926            0.7712408     0.18911504             0.051018530
area_mean                0.95921333       0.12352294        0.39041031      0.51260592            0.7220166     0.14356991             0.003737597
smoothness_mean          0.20671836       0.80532420        0.47246844      0.43492571            0.5030534     0.39430948             0.499316369
compactness_mean         0.50960381       0.56554117        0.86580904      0.81627525            0.8155732     0.51022343             0.687382323
concavity_mean           0.67598723       0.44882204        0.75496802      0.88410264            0.8613230     0.40946413             0.514929891
concave.points_mean      0.80962962       0.45275305        0.66745368      0.75239950            0.9101553     0.37574415             0.368661134
symmetry_mean            0.17719338       0.42667503        0.47320001      0.43372101            0.4302966     0.69982580             0.438413498
fractal_dimension_mean  -0.23185445       0.50494208        0.45879816      0.34623388            0.1753254     0.33401868             0.767296779
radius_se                0.75154848       0.14191855        0.28710317      0.38058463            0.5310623     0.09454283             0.049559432
texture_se              -0.08319499      -0.07365766       -0.09243935     -0.06895622           -0.1196375    -0.12821476            -0.045654569
perimeter_se             0.73071297       0.13005439        0.34191945      0.41889882            0.5548972     0.10993043             0.085432572
area_se                  0.81140796       0.12538943        0.28325654      0.38510014            0.5381663     0.07412629             0.017539295
smoothness_se           -0.18219548       0.31445746       -0.05555814     -0.05829839           -0.1020068    -0.10734210             0.101480315
compactness_se           0.19937133       0.22739423        0.67878035      0.63914670            0.4832083     0.27787843             0.590972763
concavity_se             0.18835265       0.16848132        0.48485780      0.66256413            0.4404723     0.19778782             0.439329269
concave.points_se        0.34227116       0.21535060        0.45288838      0.54959238            0.6024496     0.14311567             0.310654551
symmetry_se             -0.11034274      -0.01266180        0.06025488      0.03711905           -0.0304134     0.38940248             0.078079476
fractal_dimension_se    -0.02273615       0.17056832        0.39015884      0.37997466            0.2152040     0.11109396             0.591328066
radius_worst             0.98401456       0.21657443        0.47582004      0.57397471            0.7874239     0.24352920             0.093491979
texture_worst            0.34584228       0.22542941        0.36083234      0.36836561            0.3597546     0.23302746             0.219122425
perimeter_worst          0.97757809       0.23677460        0.52940769      0.61834408            0.8163221     0.26949277             0.138956862
area_worst               1.00000000       0.20914533        0.43829628      0.54333053            0.7474188     0.20914551             0.079647034
smoothness_worst         0.20914533       1.00000000        0.56818652      0.51852329            0.5476909     0.49383833             0.617624192
compactness_worst        0.43829628       0.56818652        1.00000000      0.89226090            0.8010804     0.61444050             0.810454856
concavity_worst          0.54333053       0.51852329        0.89226090      1.00000000            0.8554339     0.53251973             0.686510921
concave.points_worst     0.74741880       0.54769090        0.80108036      0.85543386            1.0000000     0.50252849             0.511114146
symmetry_worst           0.20914551       0.49383833        0.61444050      0.53251973            0.5025285     1.00000000             0.537848206
fractal_dimension_worst  0.07964703       0.61762419        0.81045486      0.68651092            0.5111141     0.53784821             1.000000000
~~~

~~~
plot the correlation matrix
corrplot(cor(data), method="circle")
~~~

![cor](https://user-images.githubusercontent.com/41892582/231318002-f7e813a9-0941-472f-975b-418e638ccf48.png)

As we can see from the above correlation matrix, there are a lot of highly correlated variables.

Calculate the partial correlation coefficient, t-statistic, and corresponding p-value.

~~~
pcor(data,method="pearson")
~~~

~~~
$estimate
              [,1]        [,2]         [,3]        [,4]        [,5]        [,6]        [,7]        [,8]         [,9]       [,10]       [,11]
 [1,]  1.000000000  0.14301740 -0.003968033 -0.05304634 -0.14274564 -0.09739092 -0.25139995 -0.33032331 -0.161364466 -0.14116328 -0.24316062
 [2,]  0.143017401  1.00000000  0.070806957  0.81226934  0.46963034  0.99665504  0.95784450 -0.02237185  0.976065129  0.99199565  0.95820691
 [3,] -0.003968033  0.07080696  1.000000000  0.11718859 -0.17837428 -0.07779706 -0.11217362 -0.16309621 -0.112842636 -0.09950900 -0.11421305
 [4,] -0.053046337  0.81226934  0.117188595  1.00000000  0.10093542 -0.79990494 -0.73097779  0.17269932 -0.750364045 -0.77513708 -0.72675681
 [5,] -0.142745635  0.46963034 -0.178374278  0.10093542  1.00000000 -0.47577420 -0.52621509 -0.24791238 -0.524106624 -0.50925620 -0.53208838
 [6,] -0.097390920  0.99665505 -0.077797056 -0.79990494 -0.47577420  1.00000000 -0.94512985  0.05935687 -0.970405834 -0.99036205 -0.94690958
 [7,] -0.251399951  0.95784450 -0.112173622 -0.73097779 -0.52621509 -0.94512985  1.00000000 -0.26309467 -0.993690479 -0.98011693 -0.99981250
 [8,] -0.330323311 -0.02237185 -0.163096208  0.17269932 -0.24791238  0.05935687 -0.26309468  1.00000000 -0.182628909 -0.07916626 -0.26010446
 [9,] -0.161364469  0.97606513 -0.112842637 -0.75036404 -0.52410663 -0.97040583 -0.99369048 -0.18262891  1.000000000 -0.99440494 -0.99474010
[10,] -0.141163273  0.99199565 -0.099508998 -0.77513708 -0.50925620 -0.99036204 -0.98011693 -0.07916625 -0.994404932  1.00000000 -0.98156598
[11,] -0.243160621  0.95820691 -0.114213055 -0.72675681 -0.53208838 -0.94690958 -0.99981250 -0.26010446 -0.994740101 -0.98156599  1.00000000
[12,] -0.271055106  0.86049659 -0.097616749 -0.58395901 -0.57760193 -0.86351178 -0.92971018 -0.30722425 -0.923099746 -0.90679334 -0.93496614
[13,] -0.034102478  0.04695256 -0.347614748  0.17482822 -0.22128779 -0.06836507 -0.09061591 -0.17227234 -0.102774690 -0.09263787 -0.09683794
[14,] -0.009822607 -0.31540607  0.398987628  0.06403175  0.31009555  0.33159816  0.30108049  0.01661606  0.321231903  0.32710052  0.30129457
[15,]  0.007142905  0.09943677 -0.264791064  0.03710131 -0.08555519 -0.11757253 -0.08427218  0.03062713 -0.098303625 -0.10614997 -0.08374228
[16,] -0.018368289  0.98523643 -0.112873503 -0.77797540 -0.48402514 -0.99229049 -0.93774773  0.03770606 -0.969108815 -0.98598086 -0.94053502
[17,] -0.246285879 -0.55607624 -0.084031913  0.56725051  0.06215991  0.58952960  0.29700681 -0.84039027  0.378242997  0.47229354  0.30071947
[18,] -0.122500669 -0.78575049 -0.036211284  0.72592393  0.21780051  0.80915224  0.57725734 -0.63428547  0.644022225  0.72011673  0.58010540
[19,] -0.052187244 -0.82840883 -0.009592941  0.73635638  0.26806991  0.84952542  0.63703982 -0.57349582  0.697152452  0.76850702  0.63964741
[20,] -0.168966605  0.94293093 -0.160666767 -0.68600126 -0.55243512 -0.93995022 -0.98309083 -0.25629544 -0.987350842 -0.97472515 -0.98546924
[21,] -0.355128062 -0.20526270 -0.148231521  0.32389766 -0.16113549  0.24168647 -0.08286922 -0.98034434  0.002662260  0.10548628 -0.07984704
[22,] -0.345945348  0.60791174 -0.160550435 -0.25310345 -0.60846451 -0.62699693 -0.71768063 -0.37790124 -0.701718207 -0.67936328 -0.72661897
[23,] -0.059592272 -0.05561806  0.903365230 -0.17520530  0.21559201  0.07008644  0.10852980  0.20899622  0.116369181  0.09867488  0.11280948
[24,]  0.078563601 -0.16828299 -0.257465417  0.42333221 -0.23850472  0.16199932  0.26279962  0.30305826  0.239027938  0.20746910  0.26418354
[25,]  0.236040382 -0.43574452  0.259885389 -0.08546878  0.80981235  0.45823411  0.47895410  0.16321514  0.480170911  0.47804835  0.48636072
[26,] -0.113611571  0.99363211 -0.090274371 -0.78032715 -0.50481882 -0.99417079 -0.97148122 -0.04303182 -0.989596224 -0.99868610 -0.97315977
[27,] -0.332445377 -0.19238388 -0.133826571  0.30218020 -0.15829323  0.23069744 -0.09515360 -0.98362487 -0.009581741  0.09441057 -0.09146350
[28,] -0.149358409 -0.69738618 -0.058889879  0.67023414  0.14869900  0.72396456  0.46473053 -0.73114288  0.536564592  0.62173648  0.46773132
[29,] -0.253631289 -0.11354184 -0.136407771  0.23943160 -0.20285440  0.14771847 -0.17242192 -0.99126729 -0.094732943  0.01013190 -0.16994347
[30,] -0.220218396  0.91325144 -0.131493904 -0.65934917 -0.56021719 -0.90289910 -0.98826834 -0.36965025 -0.978220968 -0.95277878 -0.98922346
[31,] -0.377000803  0.31927604 -0.170673077 -0.10538982 -0.40638225 -0.28460002 -0.57691242 -0.93808743 -0.505940552 -0.41394222 -0.57458559
            [,12]       [,13]        [,14]        [,15]       [,16]       [,17]       [,18]       [,19]       [,20]        [,21]       [,22]
 [1,] -0.27105511 -0.03410248 -0.009822607  0.007142905 -0.01836829 -0.24628588 -0.12250067 -0.05218724 -0.16896661 -0.355128066 -0.34594535
 [2,]  0.86049659  0.04695256 -0.315406066  0.099436768  0.98523643 -0.55607624 -0.78575049 -0.82840883  0.94293094 -0.205262697  0.60791174
 [3,] -0.09761675 -0.34761475  0.398987628 -0.264791064 -0.11287350 -0.08403191 -0.03621128 -0.00959294 -0.16066677 -0.148231522 -0.16055044
 [4,] -0.58395901  0.17482822  0.064031753  0.037101306 -0.77797540  0.56725051  0.72592393  0.73635638 -0.68600127  0.323897657 -0.25310345
 [5,] -0.57760193 -0.22128779  0.310095547 -0.085555190 -0.48402514  0.06215991  0.21780051  0.26806991 -0.55243513 -0.161135489 -0.60846451
 [6,] -0.86351179 -0.06836507  0.331598165 -0.117572532 -0.99229049  0.58952959  0.80915224  0.84952542 -0.93995022  0.241686462 -0.62699693
 [7,] -0.92971019 -0.09061591  0.301080488 -0.084272178 -0.93774773  0.29700681  0.57725735  0.63703982 -0.98309084 -0.082869227 -0.71768063
 [8,] -0.30722426 -0.17227234  0.016616065  0.030627126  0.03770606 -0.84039028 -0.63428547 -0.57349582 -0.25629545 -0.980344348 -0.37790125
 [9,] -0.92309975 -0.10277469  0.321231904 -0.098303625 -0.96910881  0.37824299  0.64402222  0.69715245 -0.98735085  0.002662253 -0.70171821
[10,] -0.90679333 -0.09263787  0.327100524 -0.106149968 -0.98598085  0.47229354  0.72011673  0.76850703 -0.97472515  0.105486278 -0.67936328
[11,] -0.93496614 -0.09683794  0.301294569 -0.083742283 -0.94053502  0.30071946  0.58010540  0.63964741 -0.98546924 -0.079847042 -0.72661897
[12,]  1.00000000 -0.11163257  0.136033831  0.052458358 -0.85584286  0.21668600  0.48159953  0.54143905 -0.93727856 -0.153370888 -0.89131213
[13,] -0.11163257  1.00000000  0.581174030 -0.401273871 -0.15168808 -0.10189698 -0.05400424 -0.02058377 -0.23845973 -0.182385851 -0.17357497
[14,]  0.13603383  0.58117403  1.000000000  0.877785709  0.36933606 -0.17889762 -0.24944268 -0.29818319  0.35074529 -0.048930099  0.20353680
[15,]  0.05245836 -0.40127387  0.877785709  1.000000000 -0.13639694  0.10135514  0.11111498  0.14948452 -0.10849066  0.056972046 -0.09576995
[16,] -0.85584286 -0.15168808  0.369336063 -0.136396940  1.00000000  0.57056105  0.79048768  0.82849578 -0.95196324  0.222034483 -0.61312110
[17,]  0.21668600 -0.10189698 -0.178897619  0.101355141  0.57056105  1.00000000 -0.95094162 -0.92267512  0.30216306 -0.925340782  0.03422310
[18,]  0.48159952 -0.05400424 -0.249442682  0.111114983  0.79048768 -0.95094162  1.00000000 -0.99510352  0.57567121 -0.764794085  0.25151564
[19,]  0.54143905 -0.02058378 -0.298183193  0.149484522  0.82849578 -0.92267513 -0.99510352  1.00000000  0.63320631 -0.710252183  0.32241247
[20,] -0.93727855 -0.23845972  0.350745288 -0.108490656 -0.95196323  0.30216306  0.57567122  0.63320631  1.00000000 -0.079066761 -0.73756212
[21,] -0.15337089 -0.18238585 -0.048930100  0.056972046  0.22203449 -0.92534078 -0.76479408 -0.71025218 -0.07906677  1.000000000 -0.27658676
[22,] -0.89131213 -0.17357498  0.203536803 -0.095769950 -0.61312110  0.03422310  0.25151564  0.32241248 -0.73756213 -0.276586762  1.00000000
[23,]  0.10860129  0.57186702 -0.489889690  0.318730210  0.13058970  0.12318390  0.07059564  0.04209360  0.19787336  0.196800119  0.17989605
[24,]  0.39421964 -0.38823086  0.530784299 -0.482522965  0.13698789  0.16072604  0.05658308  0.05444906  0.22233751  0.261972622  0.33734509
[25,]  0.55048261  0.36032688 -0.548172517  0.458871008  0.45925852 -0.12136030 -0.25087373 -0.31489169  0.51619094  0.093983230  0.70639831
[26,] -0.89693048 -0.06499766  0.328165000 -0.113670464 -0.98830327  0.50456643  0.74439965  0.79019975 -0.96418186  0.142940305 -0.67130556
[27,] -0.15078829 -0.11694375 -0.052384622  0.052443167  0.21434792 -0.92061308 -0.75719082 -0.70376033 -0.08063788 -0.996279593 -0.26496246
[28,]  0.37470319 -0.06398357 -0.214346596  0.097945608  0.70361965 -0.98227431 -0.99081060 -0.97666658  0.46567644 -0.841314560  0.15876982
[29,] -0.23097812 -0.10537404 -0.045286330  0.063124795  0.12485543 -0.87851557 -0.69747351 -0.64515301 -0.16409465 -0.983162917 -0.32274197
[30,] -0.94502336 -0.09424101  0.296763970 -0.089425194 -0.90161624  0.19128205  0.48106359  0.54417696 -0.97689341 -0.191083187 -0.77160048
[31,] -0.59898275 -0.14566415  0.110255977 -0.003127406 -0.29612029 -0.60457363 -0.33187628 -0.25843622 -0.56072843 -0.857806635 -0.59804667
            [,23]       [,24]       [,25]       [,26]        [,27]       [,28]       [,29]       [,30]        [,31]
 [1,] -0.05959227  0.07856360  0.23604038 -0.11361157 -0.332445381 -0.14935841 -0.25363128 -0.22021840 -0.377000805
 [2,] -0.05561806 -0.16828299 -0.43574452  0.99363210 -0.192383874 -0.69738618 -0.11354184  0.91325144  0.319276041
 [3,]  0.90336523 -0.25746542  0.25988539 -0.09027437 -0.133826573 -0.05888988 -0.13640777 -0.13149391 -0.170673077
 [4,] -0.17520530  0.42333221 -0.08546878 -0.78032715  0.302180195  0.67023414  0.23943160 -0.65934917 -0.105389816
 [5,]  0.21559201 -0.23850472  0.80981235 -0.50481882 -0.158293233  0.14869900 -0.20285440 -0.56021719 -0.406382253
 [6,]  0.07008644  0.16199932  0.45823411 -0.99417079  0.230697441  0.72396456  0.14771847 -0.90289910 -0.284600028
 [7,]  0.10852980  0.26279962  0.47895410 -0.97148122 -0.095153598  0.46473053 -0.17242192 -0.98826834 -0.576912416
 [8,]  0.20899622  0.30305826  0.16321514 -0.04303181 -0.983624884 -0.73114288 -0.99126729 -0.36965027 -0.938087441
 [9,]  0.11636918  0.23902794  0.48017091 -0.98959622 -0.009581748  0.53656459 -0.09473294 -0.97822098 -0.505940558
[10,]  0.09867488  0.20746910  0.47804834 -0.99868610  0.094410577  0.62173649  0.01013190 -0.95277878 -0.413942217
[11,]  0.11280948  0.26418354  0.48636072 -0.97315977 -0.091463503  0.46773132 -0.16994347 -0.98922346 -0.574585596
[12,]  0.10860128  0.39421963  0.55048261 -0.89693048 -0.150788288  0.37470319 -0.23097811 -0.94502337 -0.598982752
[13,]  0.57186702 -0.38823086  0.36032688 -0.06499765 -0.116943753 -0.06398357 -0.10537404 -0.09424102 -0.145664149
[14,] -0.48988969  0.53078430 -0.54817252  0.32816500 -0.052384622 -0.21434660 -0.04528633  0.29676397  0.110255978
[15,]  0.31873021 -0.48252296  0.45887101 -0.11367046  0.052443167  0.09794561  0.06312480 -0.08942519 -0.003127407
[16,]  0.13058970  0.13698789  0.45925852 -0.98830327  0.214347917  0.70361965  0.12485543 -0.90161625 -0.296120298
[17,]  0.12318390  0.16072604 -0.12136030  0.50456644 -0.920613082 -0.98227431 -0.87851556  0.19128205 -0.604573622
[18,]  0.07059564  0.05658308 -0.25087373  0.74439965 -0.757190826 -0.99081060 -0.69747351  0.48106358 -0.331876285
[19,]  0.04209360  0.05444906 -0.31489169  0.79019975 -0.703760333 -0.97666658 -0.64515301  0.54417696 -0.258436219
[20,]  0.19787336  0.22233751  0.51619093 -0.96418185 -0.080637865  0.46567645 -0.16409464 -0.97689340 -0.560728417
[21,]  0.19680012  0.26197262  0.09398323  0.14294031 -0.996279592 -0.84131456 -0.98316290 -0.19108319 -0.857806632
[22,]  0.17989605  0.33734509  0.70639831 -0.67130555 -0.264962467  0.15876982 -0.32274196 -0.77160048 -0.598046675
[23,]  1.00000000  0.33786281 -0.31344097  0.08394689  0.168515079  0.09500609  0.17534158  0.13552891  0.200229280
[24,]  0.33786281  1.00000000  0.37423450  0.20275535  0.276736214  0.10364280  0.32288488  0.30424040  0.364878529
[25,] -0.31344097  0.37423450  1.00000000  0.47702935  0.081021787 -0.19351489  0.10785642  0.51078147  0.323801119
[26,]  0.08394689  0.20275535  0.47702935  1.00000000  0.129484585  0.64848180  0.04309108 -0.94309513 -0.381730805
[27,]  0.16851508  0.27673621  0.08102178  0.12948459  1.000000000 -0.83704587 -0.99099354 -0.20553392 -0.866763814
[28,]  0.09500609  0.10364280 -0.19351489  0.64848180 -0.837045872  1.00000000 -0.78747404  0.35980956 -0.454118958
[29,]  0.17534158  0.32288489  0.10785643  0.04309108 -0.990993553 -0.78747404  1.00000000 -0.28911634 -0.901248339
[30,]  0.13552891  0.30424040  0.51078147 -0.94309513 -0.205533919  0.35980956 -0.28911632  1.00000000 -0.665939905
[31,]  0.20022928  0.36487853  0.32380112 -0.38173080 -0.866763817 -0.45411895 -0.90124833 -0.66593991  1.000000000

$p.value
              [,1]          [,2]          [,3]          [,4]          [,5]          [,6]          [,7]          [,8]          [,9]
 [1,] 0.000000e+00  8.595484e-04  9.267017e-01  2.184367e-01  8.795289e-04  2.361729e-02  3.144511e-09  3.260567e-15  1.660243e-04
 [2,] 8.595484e-04  0.000000e+00  1.002474e-01 4.667890e-128  5.655067e-31  0.000000e+00 1.346209e-293  6.039455e-01  0.000000e+00
 [3,] 9.267017e-01  1.002474e-01  0.000000e+00  6.404763e-03  3.060495e-05  7.085753e-02  9.083977e-03  1.408054e-04  8.676690e-03
 [4,] 2.184367e-01 4.667889e-128  6.404763e-03  0.000000e+00  1.897172e-02 2.126055e-121  2.427546e-91  5.478379e-05  8.661803e-99
 [5,] 8.795289e-04  5.655068e-31  3.060495e-05  1.897172e-02  0.000000e+00  7.465230e-32  8.651528e-40  5.251251e-09  1.977228e-39
 [6,] 2.361728e-02  0.000000e+00  7.085753e-02 2.126055e-121  7.465227e-32  0.000000e+00 1.476929e-263  1.684049e-01  0.000000e+00
 [7,] 3.144511e-09 1.346216e-293  9.083977e-03  2.427546e-91  8.651531e-40 1.476943e-263  0.000000e+00  5.321388e-10  0.000000e+00
 [8,] 3.260566e-15  6.039455e-01  1.408054e-04  5.478379e-05  5.251250e-09  1.684049e-01  5.321385e-10  0.000000e+00  1.954368e-05
 [9,] 1.660242e-04  0.000000e+00  8.676690e-03  8.661804e-99  1.977227e-39  0.000000e+00  0.000000e+00  1.954368e-05  0.000000e+00
[10,] 1.004649e-03  0.000000e+00  2.073559e-02 2.268375e-109  5.679748e-37  0.000000e+00  0.000000e+00  6.602109e-02  0.000000e+00
[11,] 1.043065e-08 1.386339e-294  7.892847e-03  8.340748e-90  8.390127e-41 2.650442e-267  0.000000e+00  8.451751e-10  0.000000e+00
[12,] 1.509283e-10 1.058780e-159  2.329437e-02  1.114707e-50  2.257532e-49 4.568231e-162 1.511129e-235  2.878032e-13 1.914331e-225
[13,] 4.290236e-01  2.760872e-01  8.797964e-17  4.412876e-05  2.048448e-07  1.125498e-01  3.527595e-02  5.719492e-05  1.689141e-02
[14,] 8.198536e-01  6.152687e-14  4.729427e-22  1.372684e-01  1.683918e-13  2.517461e-15  8.885198e-13  7.000490e-01  1.991711e-14
[15,] 8.684689e-01  2.082858e-02  4.082399e-10  3.895384e-01  4.690460e-02  6.232341e-03  5.031770e-02  4.775631e-01  2.233558e-02
[16,] 6.701900e-01  0.000000e+00  8.658297e-03 1.139672e-110  4.609621e-33  0.000000e+00 2.984379e-249  3.818513e-01  0.000000e+00
[17,] 6.652442e-09  3.729891e-45  5.097940e-02  2.634895e-47  1.491575e-01  7.558233e-52  1.849050e-12 3.128033e-145  8.250654e-20
[18,] 4.360860e-03 2.499134e-114  4.010207e-01  1.663001e-89  3.204906e-07 2.474674e-126  2.652371e-49  4.011826e-62  1.374806e-64
[19,] 2.259963e-01 1.565285e-137  8.239960e-01  2.427080e-93  2.432824e-10 1.526395e-151  8.222702e-63  1.521954e-48  8.636857e-80
[20,] 7.955543e-05 4.252141e-259  1.773353e-04  2.497474e-76  1.799444e-44 2.502544e-253  0.000000e+00  1.510930e-09  0.000000e+00
[21,] 1.704645e-17  1.508306e-06  5.488333e-04  1.178996e-14  1.696596e-04  1.286825e-08  5.428497e-02  0.000000e+00  9.507842e-01
[22,] 1.259407e-16  7.176806e-56  1.792901e-04  2.440883e-09  5.381196e-56  2.463299e-60  1.344048e-86  8.955619e-20  2.969821e-81
[23,] 1.667202e-01  1.968941e-01 5.924412e-200  4.245888e-05  4.239089e-07  1.037607e-01  1.161539e-02  9.603774e-07  6.787141e-03
[24,] 6.811534e-02  8.510872e-05  1.265265e-09  6.830573e-25  2.015401e-08  1.563236e-04  5.571380e-10  6.199053e-13  1.872880e-08
[25,] 2.840427e-08  1.970120e-26  8.741133e-10  4.712822e-02 1.074008e-126  2.173461e-29  2.575396e-32  1.392127e-04  1.708814e-32
[26,] 8.228739e-03  0.000000e+00  3.597505e-02 9.243869e-112  2.922100e-36  0.000000e+00  0.000000e+00  3.182240e-01  0.000000e+00
[27,] 2.118469e-15  6.720211e-06  1.829047e-03  7.275835e-13  2.214600e-04  5.900039e-08  2.703135e-02  0.000000e+00  8.241981e-01
[28,] 4.971551e-04  7.279531e-80  1.717846e-01  1.080388e-71  5.268171e-04  8.347716e-89  2.761209e-30  2.111039e-91  1.374128e-41
[29,] 2.255781e-09  8.268493e-03  1.486284e-03  1.769642e-08  2.009309e-06  5.739772e-04  5.633906e-05  0.000000e+00  2.771863e-02
[30,] 2.351667e-07 5.818785e-212  2.199617e-03  1.176784e-68  6.083032e-46 2.025006e-199  0.000000e+00  6.296002e-19  0.000000e+00
[31,] 1.110992e-19  2.916541e-14  6.714641e-05  1.427810e-02  6.864293e-23  1.605659e-11  3.116178e-49 7.176758e-250  1.935769e-36
              [,10]         [,11]         [,12]        [,13]         [,14]         [,15]         [,16]         [,17]         [,18]
 [1,]  1.004649e-03  1.043065e-08  1.509282e-10 4.290236e-01  8.198536e-01  8.684689e-01  6.701900e-01  6.652438e-09  4.360860e-03
 [2,]  0.000000e+00 1.386334e-294 1.058777e-159 2.760872e-01  6.152687e-14  2.082858e-02  0.000000e+00  3.729894e-45 2.499135e-114
 [3,]  2.073559e-02  7.892847e-03  2.329437e-02 8.797964e-17  4.729427e-22  4.082399e-10  8.658298e-03  5.097939e-02  4.010207e-01
 [4,] 2.268375e-109  8.340746e-90  1.114707e-50 4.412876e-05  1.372684e-01  3.895384e-01 1.139672e-110  2.634896e-47  1.663001e-89
 [5,]  5.679743e-37  8.390125e-41  2.257529e-49 2.048448e-07  1.683918e-13  4.690460e-02  4.609622e-33  1.491575e-01  3.204906e-07
 [6,]  0.000000e+00 2.650419e-267 4.568208e-162 1.125497e-01  2.517461e-15  6.232341e-03  0.000000e+00  7.558246e-52 2.474677e-126
 [7,]  0.000000e+00  0.000000e+00 1.511122e-235 3.527595e-02  8.885198e-13  5.031770e-02 2.984400e-249  1.849051e-12  2.652370e-49
 [8,]  6.602107e-02  8.451747e-10  2.878028e-13 5.719492e-05  7.000490e-01  4.775631e-01  3.818513e-01 3.127992e-145  4.011822e-62
 [9,]  0.000000e+00  0.000000e+00 1.914300e-225 1.689141e-02  1.991711e-14  2.233558e-02  0.000000e+00  8.250666e-20  1.374808e-64
[10,]  0.000000e+00  0.000000e+00 5.775308e-204 3.136970e-02  6.236240e-15  1.358846e-02  0.000000e+00  2.362820e-31  1.905805e-87
[11,]  0.000000e+00  0.000000e+00 2.600752e-244 2.442440e-02  8.546761e-13  5.178669e-02 1.949991e-254  9.485875e-13  6.959156e-50
[12,] 5.775283e-204 2.600771e-244  0.000000e+00 9.425723e-03  1.531981e-03  2.235908e-01 3.699718e-156  3.692052e-07  1.053466e-32
[13,]  3.136970e-02  2.442440e-02  9.425722e-03 0.000000e+00  4.198066e-50  2.617546e-22  4.043430e-04  1.785784e-02  2.102234e-01
[14,]  6.236240e-15  8.546761e-13  1.531981e-03 4.198066e-50  0.000000e+00 4.358300e-174  6.773891e-19  2.897835e-05  4.197150e-09
[15,]  1.358846e-02  5.178669e-02  2.235908e-01 2.617546e-22 4.358300e-174  0.000000e+00  1.487590e-03  1.847827e-02  9.763298e-03
[16,]  0.000000e+00 1.949979e-254 3.699703e-156 4.043430e-04  6.773890e-19  1.487590e-03  0.000000e+00  5.856354e-48 1.237752e-116
[17,]  2.362821e-31  9.485870e-13  3.692051e-07 1.785784e-02  2.897835e-05  1.847827e-02  5.856345e-48  0.000000e+00 2.726905e-276
[18,]  1.905808e-87  6.959157e-50  1.053467e-32 2.102234e-01  4.197150e-09  9.763298e-03 1.237750e-116 2.726873e-276  0.000000e+00
[19,] 2.075117e-106  1.806612e-63  1.857294e-42 6.331728e-01  1.498138e-12  4.916621e-04 1.383218e-137 7.938140e-225  0.000000e+00
[20,]  0.000000e+00  0.000000e+00 2.108423e-248 2.028137e-08  4.464009e-17  1.164567e-02 1.091099e-278  7.298568e-13  5.556246e-49
[21,]  1.418891e-02  6.371926e-02  3.476363e-04 2.005649e-05  2.563427e-01  1.861959e-01  1.859455e-07 9.160093e-229 8.560670e-105
[22,]  2.425429e-74  9.351458e-90 5.862969e-187 5.013620e-05  1.853123e-06  2.605085e-02  4.651341e-57  4.273919e-01  3.091063e-09
[23,]  2.183174e-02  8.696486e-03  1.156026e-02 3.220538e-48  6.079085e-34  3.242491e-14  2.360846e-03  4.146089e-03  1.012678e-01
[24,]  1.156286e-06  4.489860e-10  1.600370e-21 7.195949e-21  1.414100e-40  7.696682e-33  1.417864e-03  1.763469e-04  1.892244e-01
[25,]  3.491324e-32  2.066848e-33  4.151223e-44 5.335668e-18  1.108217e-43  1.778902e-29  1.574450e-29  4.741827e-03  3.399166e-09
[26,]  0.000000e+00  0.000000e+00 8.151874e-193 1.314255e-01  5.038148e-15  8.195297e-03  0.000000e+00  3.205114e-36  1.998462e-96
[27,]  2.825544e-02  3.359077e-02  4.380900e-04 6.516942e-03  2.242432e-01  2.237251e-01  4.955991e-07 7.078091e-222 1.409766e-101
[28,]  4.496547e-59  1.048734e-30  1.919837e-19 1.375650e-01  4.956813e-07  2.283097e-02  7.160191e-82  0.000000e+00  0.000000e+00
[29,]  8.142829e-01  7.221002e-05  5.680262e-08 1.429273e-02  2.935069e-01  1.429346e-01  3.660420e-03 9.651359e-175  6.828712e-80
[30,] 1.218563e-280  0.000000e+00 2.451979e-263 2.854136e-02  1.930918e-12  3.776449e-02 5.775506e-198  7.602288e-06  1.263412e-32
[31,]  9.071842e-24  9.195658e-49  6.955754e-54 6.857584e-04  1.034731e-02  9.421991e-01  2.165455e-12  4.035651e-55  2.378961e-15
              [,19]         [,20]         [,21]         [,22]         [,23]        [,24]         [,25]         [,26]         [,27]
 [1,]  2.259963e-01  7.955536e-05  1.704643e-17  1.259407e-16  1.667202e-01 6.811534e-02  2.840427e-08  8.228741e-03  2.118467e-15
 [2,] 1.565285e-137 4.252051e-259  1.508307e-06  7.176805e-56  1.968941e-01 8.510872e-05  1.970120e-26  0.000000e+00  6.720212e-06
 [3,]  8.239960e-01  1.773352e-04  5.488332e-04  1.792901e-04 5.924411e-200 1.265265e-09  8.741133e-10  3.597505e-02  1.829047e-03
 [4,]  2.427080e-93  2.497473e-76  1.178996e-14  2.440883e-09  4.245888e-05 6.830573e-25  4.712822e-02 9.243868e-112  7.275835e-13
 [5,]  2.432824e-10  1.799439e-44  1.696596e-04  5.381196e-56  4.239089e-07 2.015401e-08 1.074008e-126  2.922102e-36  2.214600e-04
 [6,] 1.526397e-151 2.502487e-253  1.286826e-08  2.463296e-60  1.037607e-01 1.563235e-04  2.173460e-29  0.000000e+00  5.900042e-08
 [7,]  8.222696e-63  0.000000e+00  5.428497e-02  1.344049e-86  1.161539e-02 5.571380e-10  2.575397e-32  0.000000e+00  2.703135e-02
 [8,]  1.521954e-48  1.510926e-09  0.000000e+00  8.955614e-20  9.603773e-07 6.199051e-13  1.392126e-04  3.182240e-01  0.000000e+00
 [9,]  8.636861e-80  0.000000e+00  9.507843e-01  2.969815e-81  6.787141e-03 1.872879e-08  1.708813e-32  0.000000e+00  8.241980e-01
[10,] 2.075113e-106  0.000000e+00  1.418891e-02  2.425436e-74  2.183174e-02 1.156287e-06  3.491327e-32  0.000000e+00  2.825543e-02
[11,]  1.806610e-63  0.000000e+00  6.371925e-02  9.351466e-90  8.696486e-03 4.489860e-10  2.066849e-33  0.000000e+00  3.359077e-02
[12,]  1.857292e-42 2.108360e-248  3.476363e-04 5.863015e-187  1.156026e-02 1.600371e-21  4.151226e-44 8.151958e-193  4.380900e-04
[13,]  6.331728e-01  2.028136e-08  2.005649e-05  5.013620e-05  3.220538e-48 7.195948e-21  5.335668e-18  1.314255e-01  6.516941e-03
[14,]  1.498138e-12  4.464007e-17  2.563427e-01  1.853123e-06  6.079085e-34 1.414100e-40  1.108217e-43  5.038148e-15  2.242432e-01
[15,]  4.916621e-04  1.164567e-02  1.861959e-01  2.605085e-02  3.242491e-14 7.696683e-33  1.778902e-29  8.195297e-03  2.237251e-01
[16,] 1.383219e-137 1.091070e-278  1.859456e-07  4.651337e-57  2.360846e-03 1.417864e-03  1.574449e-29  0.000000e+00  4.955993e-07
[17,] 7.938212e-225  7.298576e-13 9.160144e-229  4.273918e-01  4.146089e-03 1.763470e-04  4.741825e-03  3.205108e-36 7.078132e-222
[18,]  0.000000e+00  5.556260e-49 8.560652e-105  3.091062e-09  1.012678e-01 1.892244e-01  3.399166e-09  1.998459e-96 1.409763e-101
[19,]  0.000000e+00  7.432426e-62  4.578843e-84  1.580003e-14  3.288994e-01 2.064860e-01  6.788941e-14 1.715703e-116  6.441954e-82
[20,]  7.432405e-62  0.000000e+00  6.636314e-02  8.510621e-94  3.597153e-06 1.787654e-07  4.182681e-38 2.963095e-312  6.112879e-02
[21,]  4.578853e-84  6.636310e-02  0.000000e+00  6.134686e-11  4.070287e-06 6.334540e-10  2.898082e-02  8.651730e-04  0.000000e+00
[22,]  1.580003e-14  8.510540e-94  6.134681e-11  0.000000e+00  2.609977e-05 7.727411e-16  8.773561e-83  5.341020e-72  3.974106e-10
[23,]  3.288994e-01  3.597151e-06  4.070286e-06  2.609977e-05  0.000000e+00 6.939005e-16  8.951378e-14  5.121530e-02  8.318363e-05
[24,]  2.064860e-01  1.787653e-07  6.334538e-10  7.727411e-16  6.939005e-16 0.000000e+00  2.145312e-19  2.033003e-06  5.985576e-11
[25,]  6.788940e-14  4.182670e-38  2.898081e-02  8.773561e-83  8.951378e-14 2.145312e-19  0.000000e+00  4.911185e-32  5.990292e-02
[26,] 1.715704e-116 2.962931e-312  8.651735e-04  5.341010e-72  5.121530e-02 2.033002e-06  4.911182e-32  0.000000e+00  2.572524e-03
[27,]  6.441969e-82  6.112876e-02  0.000000e+00  3.974109e-10  8.318364e-05 5.985578e-11  5.990293e-02  2.572523e-03  0.000000e+00
[28,]  0.000000e+00  2.037133e-30 7.498262e-146  2.118493e-04  2.727066e-02 1.598089e-02  5.916763e-06  9.526818e-66 5.094703e-143
[29,]  7.016493e-65  1.279489e-04  0.000000e+00  1.480849e-14  4.187018e-05 1.439764e-14  1.214619e-02  3.175573e-01  0.000000e+00
[30,]  5.948732e-43  0.000000e+00  7.772828e-06 8.867756e-108  1.595734e-03 4.992390e-13  3.216521e-37 2.003530e-259  1.460054e-06
[31,]  1.091307e-09  4.854180e-46 1.225595e-157  1.114264e-53  2.736064e-06 1.896161e-18  1.201706e-14  3.553684e-20 1.108127e-164
              [,28]         [,29]         [,30]         [,31]
 [1,]  4.971551e-04  2.255782e-09  2.351665e-07  1.110991e-19
 [2,]  7.279531e-80  8.268492e-03 5.818727e-212  2.916540e-14
 [3,]  1.717846e-01  1.486284e-03  2.199617e-03  6.714640e-05
 [4,]  1.080388e-71  1.769642e-08  1.176784e-68  1.427810e-02
 [5,]  5.268171e-04  2.009310e-06  6.083019e-46  6.864290e-23
 [6,]  8.347723e-89  5.739772e-04 2.024983e-199  1.605658e-11
 [7,]  2.761208e-30  5.633909e-05  0.000000e+00  3.116177e-49
 [8,]  2.111037e-91  0.000000e+00  6.295984e-19 7.176534e-250
 [9,]  1.374129e-41  2.771862e-02  0.000000e+00  1.935764e-36
[10,]  4.496539e-59  8.142828e-01 1.218558e-280  9.071851e-24
[11,]  1.048733e-30  7.221006e-05  0.000000e+00  9.195654e-49
[12,]  1.919835e-19  5.680269e-08 2.451935e-263  6.955761e-54
[13,]  1.375650e-01  1.429273e-02  2.854136e-02  6.857583e-04
[14,]  4.956813e-07  2.935069e-01  1.930917e-12  1.034731e-02
[15,]  2.283097e-02  1.429346e-01  3.776449e-02  9.421991e-01
[16,]  7.160196e-82  3.660420e-03 5.775446e-198  2.165454e-12
[17,]  0.000000e+00 9.651569e-175  7.602290e-06  4.035659e-55
[18,]  0.000000e+00  6.828727e-80  1.263414e-32  2.378960e-15
[19,]  0.000000e+00  7.016496e-65  5.948742e-43  1.091306e-09
[20,]  2.037127e-30  1.279491e-04  0.000000e+00  4.854208e-46
[21,] 7.498311e-146  0.000000e+00  7.772823e-06 1.225602e-157
[22,]  2.118493e-04  1.480850e-14 8.867686e-108  1.114262e-53
[23,]  2.727066e-02  4.187019e-05  1.595734e-03  2.736064e-06
[24,]  1.598089e-02  1.439764e-14  4.992387e-13  1.896161e-18
[25,]  5.916763e-06  1.214619e-02  3.216516e-37  1.201706e-14
[26,]  9.526828e-66  3.175573e-01 2.003472e-259  3.553679e-20
[27,] 5.094733e-143  0.000000e+00  1.460053e-06 1.108133e-164
[28,]  0.000000e+00 3.680754e-115  5.995173e-18  7.850243e-29
[29,] 3.680744e-115  0.000000e+00  7.400273e-12 1.496969e-197
[30,]  5.995165e-18  7.400291e-12  0.000000e+00  1.766388e-70
[31,]  7.850251e-29 1.497011e-197  1.766379e-70  0.000000e+00

$statistic
             [,1]        [,2]        [,3]        [,4]       [,5]        [,6]         [,7]         [,8]          [,9]        [,10]
 [1,]  0.00000000   3.3517190 -0.09203856  -1.2321354  -3.345217   -2.269755    -6.024671   -8.1174415   -3.79252233   -3.3073768
 [2,]  3.35171896   0.0000000  1.64648773  32.3007218  12.338259  282.871596    77.333900   -0.5190412  104.10072810  182.2190249
 [3,] -0.09203856   1.6464877  0.00000000   2.7370282  -4.204794   -1.809975    -2.618373   -3.8343293   -2.63419033   -2.3196070
 [4,] -1.23213538  32.3007218  2.73702819   0.0000000   2.353197  -30.916231   -24.845944    4.0668368  -26.32966861  -28.4573716
 [5,] -3.34521733  12.3382593 -4.20479402   2.3531974   0.000000  -12.546508   -14.353438   -5.9355790  -14.27408510  -13.7251965
 [6,] -2.26975550 282.8716229 -1.80997491 -30.9162312 -12.546508    0.000000   -67.102737    1.3792041  -93.21024348 -165.8542772
 [7,] -6.02467098  77.3338996 -2.61837330 -24.8459437 -14.353438  -67.102736     0.000000   -6.3252748 -205.50159175 -114.5729052
 [8,] -8.11744153  -0.5190412 -3.83432935   4.0668368  -5.935579    1.379204    -6.325275    0.0000000   -4.30850678   -1.8420290
 [9,] -3.79252239 104.1007302 -2.63419035 -26.3296686 -14.274085  -93.210243  -205.501645   -4.3085068    0.00000000 -218.3459845
[10,] -3.30737668 182.2190053 -2.31960699 -28.4573716 -13.725196 -165.854257  -114.572899   -1.8420289 -218.34590437    0.0000000
[11,] -5.81458734  77.6906806 -2.66660154 -24.5408715 -14.576427  -68.315406 -1197.613516   -6.2481358 -225.25212588 -119.1232175
[12,] -6.53159416  39.1772035 -2.27506914 -16.6852788 -16.411946  -39.714194   -58.552640   -7.4881623  -55.67689116  -49.8912246
[13,] -0.79146144   1.0902588 -8.59912748   4.1185402  -5.263215   -1.589435    -2.110503   -4.0564740   -2.39653160   -2.1579991
[14,] -0.22784467  -7.7092963 10.09257358   1.4882595   7.565554    8.152632     7.323321    0.3854599    7.86791341    8.0287026
[15,]  0.16568268   2.3179064 -6.36912365   0.8611513  -1.991741   -2.746121    -1.961657    0.7107243   -2.29123323   -2.4761199
[16,] -0.42612118 133.4841693 -2.63492020 -28.7206046 -12.829926 -185.712122   -62.625462    0.8752079  -91.14052728 -137.0601902
[17,] -5.89411338 -15.5187181 -1.95602401  15.9763860   1.444582   16.928618     7.214577  -35.9656164    9.47739091   12.4282431
[18,] -2.86294429 -29.4649355 -0.84046568  24.4813783   5.176106   31.940396    16.397260  -19.0300896   19.52660356   24.0727998
[19,] -1.21212583 -34.3045506 -0.22251684  25.2435901   6.454057   37.351306    19.168962  -16.2377911   22.55518733   27.8590740
[20,] -3.97632364  65.6813315 -3.77568894 -21.8687095 -15.372259  -63.877068  -124.523806   -6.1501527 -144.44235413 -101.1988672
[21,] -8.81148732  -4.8646155 -3.47661170   7.9408230  -3.786997    5.777143    -1.928771 -115.2538918    0.06175087    2.4604634
[22,] -8.55220103  17.7585968 -3.77288278  -6.0682785 -17.784231  -18.668395   -23.904563   -9.4674004  -22.84529064  -21.4740646
[23,] -1.38469330  -1.2920513 48.85699305  -4.1277042   5.121048    1.629650     2.532288    4.9571015    2.71762649    2.2999713
[24,]  1.82791905  -3.9597661 -6.18021625  10.8381827  -5.696468    3.807845     6.317655    7.3762751    5.70972112    4.9192450
[25,]  5.63411771 -11.2291427  6.24249198  -1.9897141  32.016039   11.958015    12.655220    3.8372018   12.69698957   12.6241893
[26,] -2.65237421 204.5485122 -2.10248300 -28.9420809 -13.564460 -213.877947   -95.030664   -0.9990410 -159.54059100 -452.0297906
[27,] -8.17604597  -4.5472546 -3.13225957   7.3527525  -3.718466    5.499329    -2.217131 -126.5897516   -0.22225703    2.1996621
[28,] -3.50364238 -22.5699065 -1.36831530  20.9472088   3.487824   24.342314    12.173830  -24.8579989   14.74833965   18.4123881
[29,] -6.08180291  -2.6507250 -3.19380789   5.7199495  -4.805076    3.464310    -4.060104 -174.3582960   -2.20724079    0.2350196
[30,] -5.23648007  51.9953297 -3.07669336 -20.3415007 -15.686856  -48.720399  -150.088942   -9.2275523 -109.31290086  -72.7759854
[31,] -9.44109946   7.8145524 -4.01768106  -2.4581882 -10.316224   -6.886010   -16.382572  -62.8142777  -13.60495499  -10.5473854
             [,11]      [,12]       [,13]       [,14]       [,15]        [,16]        [,17]        [,18]        [,19]       [,20]
 [1,]    -5.814587  -6.531594  -0.7914614  -0.2278447   0.1656827   -0.4261211   -5.8941135   -2.8629443   -1.2121258   -3.976324
 [2,]    77.690681  39.177204   1.0902588  -7.7092963   2.3179064  133.4841671  -15.5187180  -29.4649355  -34.3045507   65.681334
 [3,]    -2.666602  -2.275069  -8.5991275  10.0925736  -6.3691236   -2.6349202   -1.9560240   -0.8404657   -0.2225168   -3.775689
 [4,]   -24.540871 -16.685279   4.1185402   1.4882595   0.8611513  -28.7206046   15.9763860   24.4813782   25.2435901  -21.868710
 [5,]   -14.576427 -16.411947  -5.2632147   7.5655535  -1.9917407  -12.8299261    1.4445818    5.1761063    6.4540571  -15.372259
 [6,]   -68.315408 -39.714195  -1.5894346   8.1526321  -2.7461208 -185.7121236   16.9286183   31.9403958   37.3513063  -63.877071
 [7,] -1197.612209 -58.552641  -2.1105031   7.3233212  -1.9616567  -62.6254615    7.2145767   16.3972603   19.1689622 -124.523835
 [8,]    -6.248136  -7.488162  -4.0564741   0.3854600   0.7107243    0.8752080  -35.9656177  -19.0300897  -16.2377911   -6.150153
 [9,]  -225.252189 -55.676893  -2.3965316   7.8679134  -2.2912332  -91.1405273    9.4773907   19.5266035   22.5551873 -144.442409
[10,]  -119.123209 -49.891224  -2.1579990   8.0287026  -2.4761199 -137.0601797   12.4282431   24.0727999   27.8590741 -101.198874
[11,]     0.000000 -61.133686  -2.2567456   7.3290481  -1.9492346  -64.2206538    7.3136662   16.5190425   19.3015742 -134.573184
[12,]   -61.133686   0.000000  -2.6055842   3.1848873   1.2184402  -38.3792507    5.1483112   12.7461516   14.9375373  -62.367132
[13,]    -2.256746  -2.605584   0.0000000  16.5649717 -10.1614668   -3.5595686   -2.3758492   -1.2544495   -0.4775383   -5.695329
[14,]     7.329048   3.184887  16.5649717   0.0000000  42.5006560    9.2184697   -4.2175379   -5.9746409   -7.2459349    8.687378
[15,]    -1.949235   1.218440 -10.1614668  42.5006560   0.0000000   -3.1935495    2.3630841    2.5933520    3.5066683   -2.531363
[16,]   -64.220655 -38.379251  -3.5595686   9.2184697  -3.1935495    0.0000000   16.1144367   29.9361393   34.3160309  -72.108859
[17,]     7.313666   5.148311  -2.3758492  -4.2175379   2.3630841   16.1144368    0.0000000  -71.2961788  -55.5043953    7.352294
[18,]    16.519042  12.746152  -1.2544495  -5.9746409   2.5933520   29.9361394  -71.2961805    0.0000000 -233.5256624   16.329828
[19,]    19.301574  14.937537  -0.4775383  -7.2459349   3.5066683   34.3160309  -55.5043964 -233.5256770    0.0000000   18.976011
[20,]  -134.573147 -62.367128  -5.6953286   8.6873776  -2.5313634  -72.1088546    7.3522937   16.3298280   18.9760109    0.000000
[21,]    -1.857971  -3.600004  -4.3025752  -1.1362862   1.3236066    5.2818939  -56.6105432  -27.5336961  -23.4025698   -1.839700
[22,]   -24.531010 -45.598318  -4.0880961   4.8219371  -2.2316251  -18.0018190    0.7942641    6.0276306    7.9001767  -25.334150
[23,]     2.633406   2.533976  16.1692155 -13.0340784   7.7996807    3.0551685    2.8791573    1.6415494    0.9772200    4.682217
[24,]     6.353413   9.949613  -9.7713949  14.5266656 -12.7779996    3.2076497    3.7771188    1.3145408    1.2648128    5.289477
[25,]    12.910956  15.294245   8.9595689 -15.2024085  11.9790647   11.9918834   -2.8358925   -6.0112123   -7.6953385   13.979369
[26,]   -98.084650 -47.049942  -1.5108041   8.0579779  -2.6537671 -150.3169347   13.5553611   25.8579197   29.9070986  -84.315559
[27,]    -2.130410  -3.537961  -2.7312303  -1.2167228   1.2180864    5.0900695  -54.6857124  -26.8877505  -22.9768274   -1.876492
[28,]    12.274360   9.374129  -1.4871351  -5.0900366   2.2828077   22.9677297 -121.5459464 -169.9116859 -105.4827706   12.205461
[29,]    -3.999994  -5.506396  -2.4578161  -1.0514874   1.4670946    2.9188401  -42.6552891  -22.5754103  -19.5852967   -3.858450
[30,]  -156.712627 -67.032000  -2.1956761   7.2081080  -2.0825455  -48.3492481    4.5202195   12.7276932   15.0447377 -106.017783
[31,]   -16.283833 -17.350102  -3.4150796   2.5730557  -0.0725400   -7.1909693  -17.6046621   -8.1603159   -6.2051838  -15.707732
              [,21]       [,22]      [,23]      [,24]      [,25]        [,26]        [,27]       [,28]        [,29]       [,30]        [,31]
 [1,]   -8.81148744  -8.5522010  -1.384693   1.827919   5.634118   -2.6523741   -8.1760461   -3.503642   -6.0818028   -5.236480  -9.44109953
 [2,]   -4.86461543  17.7585968  -1.292051  -3.959766 -11.229143  204.5484965   -4.5472545  -22.569907   -2.6507250   51.995331   7.81455246
 [3,]   -3.47661173  -3.7728828  48.856993  -6.180216   6.242492   -2.1024830   -3.1322596   -1.368315   -3.1938079   -3.076693  -4.01768108
 [4,]    7.94082303  -6.0682785  -4.127704  10.838183  -1.989714  -28.9420809    7.3527525   20.947209    5.7199495  -20.341501  -2.45818824
 [5,]   -3.78699716 -17.7842305   5.121048  -5.696468  32.016039  -13.5644598   -3.7184660    3.487824   -4.8050755  -15.686856 -10.31622356
 [6,]    5.77714256 -18.6683952   1.629650   3.807845  11.958015 -213.8779454    5.4993287   24.342314    3.4643098  -48.720400  -6.88601006
 [7,]   -1.92877152 -23.9045632   2.532288   6.317655  12.655220  -95.0306587   -2.2171313   12.173830   -4.0601040 -150.088973 -16.38257245
 [8,] -115.25392040  -9.4674005   4.957101   7.376275   3.837202   -0.9990409 -126.5897878  -24.857999 -174.3582590   -9.227553 -62.81428189
 [9,]    0.06175071 -22.8452908   2.717627   5.709721  12.696990 -159.5405873   -0.2222572   14.748340   -2.2072408 -109.312921 -13.60495521
[10,]    2.46046350 -21.4740644   2.299971   4.919245  12.624189 -452.0292117    2.1996621   18.412388    0.2350198  -72.775986 -10.54738525
[11,]   -1.85797059 -24.5310096   2.633406   6.353413  12.910956  -98.0846450   -2.1304099   12.274360   -3.9999940 -156.712664 -16.28383302
[12,]   -3.60000396 -45.5983172   2.533975   9.949613  15.294245  -47.0499413   -3.5379610    9.374130   -5.5063960  -67.032003 -17.35010229
[13,]   -4.30257521  -4.0880961  16.169216  -9.771395   8.959569   -1.5108041   -2.7312304   -1.487135   -2.4578160   -2.195676  -3.41507965
[14,]   -1.13628622   4.8219371 -13.034078  14.526666 -15.202408    8.0579778   -1.2167228   -5.090037   -1.0514874    7.208108   2.57305568
[15,]    1.32360659  -2.2316251   7.799681 -12.778000  11.979065   -2.6537671    1.2180864    2.282808    1.4670946   -2.082546  -0.07254001
[16,]    5.28189377 -18.0018191   3.055168   3.207650  11.991883 -150.3169331    5.0900694   22.967730    2.9188401  -48.349249  -7.19096936
[17,]  -56.61054252   0.7942642   2.879157   3.777119  -2.835893   13.5553613  -54.6857117 -121.545933  -42.6552869    4.520219 -17.60466195
[18,]  -27.53369633   6.0276306   1.641549   1.314541  -6.011212   25.8579198  -26.8877507 -169.911680  -22.5754101   12.727693  -8.16031589
[19,]  -23.40256996   7.9001767   0.977220   1.264813  -7.695338   29.9070987  -22.9768276 -105.482771  -19.5852966   15.044738  -6.20518391
[20,]   -1.83969935 -25.3341487   4.682217   5.289477  13.979369  -84.3155500   -1.8764922   12.205461   -3.8584495 -106.017774 -15.70773192
[21,]    0.00000000  -6.6758124   4.655795   6.296306   2.189616    3.3498746 -268.1429777  -36.100815 -124.7969131   -4.515342 -38.71155454
[22,]   -6.67581254   0.0000000   4.241861   8.311896  23.148417  -21.0081237   -6.3735577    3.729951   -7.9091885  -28.135403 -17.30787202
[23,]    4.65579518   4.2418611   0.000000   8.326294  -7.656013    1.9540308    3.9653868    2.213663    4.1310168    3.172844   4.74027858
[24,]    6.29630622   8.3118957   8.326294   0.000000   9.360493    4.8026287    6.6797189    2.416993    7.9130984    7.407976   9.09000346
[25,]    2.18961647  23.1484174  -7.656013   9.360493   0.000000   12.5893416    1.8854852   -4.575025    2.5163905   13.780786   7.93817900
[26,]    3.34987447 -21.0081238   1.954031   4.802629  12.589342    0.0000000    3.0288713   19.759363    1.0004195  -65.784702  -9.57960983
[27,] -268.14298685  -6.3735575   3.965387   6.679719   1.885485    3.0288714    0.0000000  -35.485237 -171.6524496   -4.871327 -40.31216536
[28,]  -36.10081519   3.7299507   2.213663   2.416993  -4.575024   19.7593633  -35.4852372    0.000000  -29.6347667    8.944791 -11.82256733
[29,] -124.79696025  -7.9091886   4.131017   7.913099   2.516391    1.0004195 -171.6525661  -29.634767    0.0000000   -7.005166 -48.24407539
[30,]   -4.51534185 -28.1354026   3.172844   7.407976  13.780786  -65.7846979   -4.8713265    8.944791   -7.0051658    0.000000 -20.70542798
[31,]  -38.71155506 -17.3078719   4.740279   9.090003   7.938179   -9.5796097  -40.3121659  -11.822567  -48.2440723  -20.705428   0.00000000

$n
[1] 569

$gp
[1] 29

$method
[1] "pearson"
~~~
# Factor analysis

 We can safely assume that the independent variable has a high degree of correlation.
 and let's check the suitability for factor analysis.

**Kaiser-Meyer-Olkin (KMO) and Bartlett's Test**

Prior to the extraction of the constructs, there are some tests which must be conducted to examine the adequacy of the sample and the suitability of data for FA (LauraJ. Burton and Stephanie M. Mazerolle 2011)[^4].

[^4]: [Exploratory Factor Analysis; Concepts and Theory](https://hal.science/hal-02557344v1/preview/Exploratory%20Factor%20Analysis%3B%20Concepts%20and%20Theory.pdf)

~~~
##new dataset of all independent variable
data2<-dplyr::select(data,-diagnosis)
EFAtools::KMO(cor(data2))
~~~

~~~
── Kaiser-Meyer-Olkin criterion (KMO) ──────────────────────────

✔ The overall KMO value for your data is meritorious.
  These data are probably suitable for factor analysis.

  Overall: 0.832

  For each variable:
            radius_mean            texture_mean 
                  0.835                   0.644 
         perimeter_mean               area_mean 
                  0.853                   0.864 
        smoothness_mean        compactness_mean 
                  0.815                   0.879 
         concavity_mean     concave.points_mean 
                  0.892                   0.900 
          symmetry_mean  fractal_dimension_mean 
                  0.825                   0.832 
              radius_se              texture_se 
                  0.834                   0.485 
           perimeter_se                 area_se 
                  0.843                   0.852 
          smoothness_se          compactness_se 
                  0.644                   0.871 
           concavity_se       concave.points_se 
                  0.825                   0.835 
            symmetry_se    fractal_dimension_se 
                  0.583                   0.811 
           radius_worst           texture_worst 
                  0.823                   0.603 
        perimeter_worst              area_worst 
                  0.885                   0.820 
       smoothness_worst       compactness_worst 
                  0.753                   0.851 
        concavity_worst    concave.points_worst 
                  0.902                   0.891 
         symmetry_worst fractal_dimension_worst 
                  0.691                   0.812 
~~~

We can perform a factor analysis on this data because MSA > 0.5, and Bartlett's test should be significant.

~~~
bart_spher(data2)
~~~

~~~
	Bartlett's Test of Sphericity

Call: bart_spher(x = data2)

     X2 = 39362.121
     df = 435
p-value < 2.22e-16
~~~

**How many factors do we need?**

A number of criteria are available to assist these decisions, but they do not always lead to the same or even similar results (Zwick and Velicer 1986; Thompson and Daniel 1996). Factor retentions methods are; Cumulative percent of variance extracted, Kaiser‟s criteria (eigenvalue > 1 rule) (Kaiser 1960), Scree test (Cattell 1966) and Parallel Analysis (Horn 1965). (Hair, Anderson et al. 1995a) mentioned that the majority of factor analysts commonly use multiple criteria[^4].

~~~
nafactor<-fa.parallel(data2,fm = "ml",fa = "fa")
~~~

~~~
Parallel analysis suggests that the number of factors =  6  and the number of components =  NA 
~~~

![pa ](https://user-images.githubusercontent.com/41892582/231321967-9dfbf198-5faf-4297-a785-ddf559c0d3dc.jpg)

~~~
nafactor$fa.values
~~~

~~~
 [1] 12.851051386  5.045653741  2.026360364  1.111542316  0.764096508
 [6]  0.262565575  0.132322728 -0.002337678 -0.007820779 -0.044264397
[11] -0.045704466 -0.056125272 -0.137929943 -0.246489814 -0.338587657
[16] -0.389916735 -0.441766202 -0.464942433 -0.520668594 -0.555389766
[21] -0.564948680 -0.655167401 -0.672506623 -0.754179503 -0.774925666
[26] -0.825778595 -0.864061339 -0.877241261 -0.897615476 -0.921281077
~~~

~~~
sum(nafactor$fa.values>1)
~~~

~~~
4
~~~

**Run the Factor Analysis**


Four factors will be used since they have eigenvalues greater than 1, and let's also use the oblimin rotation because of the multicollinearity of the variables.

~~~
fit<-fa(data2,nfactors = 4,rotate = "oblimin")
print(fit)
~~~

~~~
Factor Analysis using method =  minres
Call: fa(r = data2, nfactors = 4, rotate = "oblimin")
Standardized loadings (pattern matrix) based upon correlation matrix
                          MR1   MR2   MR3   MR4   h2     u2 com
radius_mean              0.97  0.00 -0.13  0.04 0.95  0.047 1.0
texture_mean             0.07 -0.05  0.10  0.89 0.83  0.171 1.0
perimeter_mean           0.96  0.05 -0.10  0.04 0.96  0.043 1.0
area_mean                0.98 -0.04 -0.06  0.03 0.96  0.036 1.0
smoothness_mean          0.09  0.62  0.14 -0.15 0.47  0.531 1.3
compactness_mean         0.33  0.74  0.21  0.01 0.92  0.082 1.6
concavity_mean           0.55  0.53  0.24  0.05 0.91  0.090 2.4
concave.points_mean      0.74  0.41  0.09  0.00 0.92  0.082 1.6
symmetry_mean            0.06  0.54  0.23 -0.05 0.42  0.585 1.4
fractal_dimension_mean  -0.43  0.72  0.40 -0.10 0.81  0.191 2.3
radius_se                0.81 -0.14  0.45 -0.01 0.84  0.160 1.6
texture_se              -0.16 -0.25  0.62  0.46 0.55  0.452 2.4
perimeter_se             0.80 -0.10  0.46 -0.01 0.85  0.152 1.6
area_se                  0.87 -0.15  0.31 -0.03 0.81  0.189 1.3
smoothness_se           -0.19  0.02  0.62 -0.03 0.40  0.597 1.2
compactness_se           0.07  0.48  0.58  0.06 0.74  0.257 2.0
concavity_se             0.11  0.37  0.54  0.02 0.58  0.423 1.9
concave.points_se        0.34  0.27  0.57 -0.04 0.66  0.343 2.1
symmetry_se             -0.09  0.06  0.58 -0.03 0.35  0.650 1.1
fractal_dimension_se    -0.13  0.38  0.66 -0.02 0.67  0.326 1.7
radius_worst             0.94  0.08 -0.17  0.08 0.98  0.020 1.1
texture_worst           -0.02  0.09 -0.05  1.00 1.02 -0.017 1.0
perimeter_worst          0.93  0.13 -0.14  0.08 0.99  0.014 1.1
area_worst               0.94  0.03 -0.11  0.07 0.95  0.053 1.0
smoothness_worst        -0.02  0.72 -0.09  0.00 0.49  0.510 1.0
compactness_worst        0.16  0.85 -0.08  0.15 0.88  0.120 1.2
concavity_worst          0.32  0.74 -0.02  0.14 0.84  0.163 1.4
concave.points_worst     0.59  0.61 -0.12  0.06 0.92  0.076 2.1
symmetry_worst          -0.01  0.67 -0.14  0.05 0.43  0.565 1.1
fractal_dimension_worst -0.24  0.92  0.02  0.08 0.81  0.192 1.2

                       MR1  MR2  MR3  MR4
SS loadings           9.87 6.99 3.77 2.26
Proportion Var        0.33 0.23 0.13 0.08
Cumulative Var        0.33 0.56 0.69 0.76
Proportion Explained  0.43 0.31 0.16 0.10
Cumulative Proportion 0.43 0.74 0.90 1.00

 With factor correlations of 
     MR1  MR2  MR3  MR4
MR1 1.00 0.28 0.08 0.27
MR2 0.28 1.00 0.24 0.15
MR3 0.08 0.24 1.00 0.02
MR4 0.27 0.15 0.02 1.00

Mean item complexity =  1.5
Test of the hypothesis that 4 factors are sufficient.

df null model =  435  with the objective function =  70.65 with Chi Square =  39362.12
df of  the model are 321  and the objective function was  27.21 

The root mean square of the residuals (RMSR) is  0.06 
The df corrected root mean square of the residuals is  0.07 

The harmonic n.obs is  569 with the empirical chi square  1672.29  with prob <  3.1e-181 
The total n.obs was  569  with Likelihood Chi Square =  15087.53  with prob <  0 

Tucker Lewis Index of factoring reliability =  0.483
RMSEA index =  0.284  and the 90 % confidence intervals are  0.281 0.288
BIC =  13051.14
Fit based upon off diagonal values = 0.99
~~~

The four factors explain 77% of the variance: factor 1 for 33%, factor 2 for 23%, factor 3 for 13%, and factor 4 for 8%, also factors are not correlated let's use the orthogonal rotation (varimax)

~~~
fit2<-fa(data2,nfactors = 4,rotate = "varimax")
print(fit2)
~~~

~~~
Factor Analysis using method =  minres
Call: fa(r = data2, nfactors = 4, rotate = "varimax")
Standardized loadings (pattern matrix) based upon correlation matrix
                          MR1   MR2   MR3   MR4   h2     u2 com
radius_mean              0.95  0.14 -0.14  0.10 0.95  0.047 1.1
texture_mean             0.25  0.06  0.07  0.87 0.83  0.171 1.2
perimeter_mean           0.95  0.18 -0.11  0.10 0.96  0.043 1.1
area_mean                0.97  0.10 -0.08  0.09 0.96  0.036 1.1
smoothness_mean          0.16  0.60  0.25 -0.13 0.47  0.531 1.6
compactness_mean         0.45  0.78  0.33  0.04 0.92  0.082 2.0
concavity_mean           0.65  0.61  0.32  0.09 0.91  0.090 2.5
concave.points_mean      0.79  0.51  0.15  0.05 0.92  0.082 1.8
symmetry_mean            0.14  0.54  0.32 -0.03 0.42  0.585 1.8
fractal_dimension_mean  -0.31  0.65  0.53 -0.10 0.81  0.191 2.5
radius_se                0.82  0.00  0.41  0.04 0.84  0.160 1.5
texture_se              -0.04 -0.18  0.56  0.45 0.55  0.452 2.2
perimeter_se             0.81  0.04  0.43  0.05 0.85  0.152 1.5
area_se                  0.86 -0.01  0.27  0.03 0.81  0.189 1.2
smoothness_se           -0.13  0.02  0.62 -0.03 0.40  0.597 1.1
compactness_se           0.20  0.52  0.66  0.08 0.74  0.257 2.1
concavity_se             0.21  0.41  0.60  0.05 0.58  0.423 2.1
concave.points_se        0.41  0.34  0.61  0.00 0.66  0.343 2.4
symmetry_se             -0.04  0.07  0.59 -0.02 0.35  0.650 1.0
fractal_dimension_se    -0.03  0.38  0.72  0.00 0.67  0.326 1.5
radius_worst             0.94  0.21 -0.17  0.13 0.98  0.020 1.2
texture_worst            0.19  0.19 -0.06  0.97 1.02 -0.017 1.2
perimeter_worst          0.94  0.26 -0.14  0.13 0.99  0.014 1.2
area_worst               0.94  0.17 -0.12  0.12 0.95  0.053 1.1
smoothness_worst         0.07  0.70  0.03  0.01 0.49  0.510 1.0
compactness_worst        0.31  0.87  0.06  0.17 0.88  0.120 1.3
concavity_worst          0.44  0.78  0.10  0.17 0.84  0.163 1.7
concave.points_worst     0.67  0.68 -0.02  0.10 0.92  0.076 2.0
symmetry_worst           0.08  0.65 -0.03  0.06 0.43  0.565 1.1
fractal_dimension_worst -0.09  0.87  0.18  0.08 0.81  0.192 1.1

                        MR1  MR2  MR3  MR4
SS loadings           10.00 6.80 3.99 2.10
Proportion Var         0.33 0.23 0.13 0.07
Cumulative Var         0.33 0.56 0.69 0.76
Proportion Explained   0.44 0.30 0.17 0.09
Cumulative Proportion  0.44 0.73 0.91 1.00

Mean item complexity =  1.5
Test of the hypothesis that 4 factors are sufficient.

df null model =  435  with the objective function =  70.65 with Chi Square =  39362.12
df of  the model are 321  and the objective function was  27.21 

The root mean square of the residuals (RMSR) is  0.06 
The df corrected root mean square of the residuals is  0.07 

The harmonic n.obs is  569 with the empirical chi square  1672.29  with prob <  3.1e-181 
The total n.obs was  569  with Likelihood Chi Square =  15087.53  with prob <  0 

Tucker Lewis Index of factoring reliability =  0.483
RMSEA index =  0.284  and the 90 % confidence intervals are  0.281 0.288
BIC =  13051.14
Fit based upon off diagonal values = 0.99
~~~

The four factors explain 76% of the variance: factor 1 for 33%, factor 2 for 23%, factor 3 for 13%, and factor 4 for 7%, The root mean square of the residuals (RMSR) is  0.06 which is good, also the root mean square error approximation (RMSEA index) =  0.284  and the 90 % confidence intervals are  0.281 0.288

~~~
fa.diagram(fit2)
~~~

![plot](https://user-images.githubusercontent.com/41892582/231516363-0294d0b8-8cab-4f5d-9cf0-ca08291037a7.jpg)

**Reliability analysis**

~~~
factor1<-c(1,3,4,7,8,11,13,14,21,23,24)
factor2<-c(5,6,9,10,25,26,27,28,29,30)
factor3<-c(12,15,16,17,18,19,20)
factor4<-c(2,22)
~~~

~~~
psych::alpha(data2[,factor1])
~~~

~~~
Reliability analysis   
Call: psych::alpha(x = data2[, factor1])

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean sd median_r
      0.62      0.98       1      0.81  48 0.0018  164 92     0.76

    95% confidence boundaries 
         lower alpha upper
Feldt     0.57  0.62  0.66
Duhachek  0.62  0.62  0.62

 Reliability if an item is dropped:
                    raw_alpha std.alpha G6(smc) average_r S/N
radius_mean              0.62      0.98       1      0.80  41
perimeter_mean           0.60      0.98       1      0.80  41
area_mean                0.31      0.98       1      0.80  40
concavity_mean           0.62      0.98       1      0.84  51
concave.points_mean      0.62      0.98       1      0.81  44
radius_se                0.62      0.98       1      0.82  47
perimeter_se             0.62      0.98       1      0.83  47
area_se                  0.59      0.98       1      0.82  45
radius_worst             0.62      0.98       1      0.80  41
perimeter_worst          0.59      0.98       1      0.80  40
area_worst               0.43      0.98       1      0.80  40
                    alpha se var.r med.r
radius_mean           0.0018 0.014  0.76
perimeter_mean        0.0018 0.015  0.76
area_mean             0.0028 0.015  0.75
concavity_mean        0.0018 0.014  0.82
concave.points_mean   0.0018 0.017  0.75
radius_se             0.0018 0.015  0.81
perimeter_se          0.0018 0.015  0.81
area_se               0.0017 0.016  0.81
radius_worst          0.0018 0.015  0.75
perimeter_worst       0.0020 0.015  0.75
area_worst            0.0033 0.015  0.74

 Item statistics 
                      n raw.r std.r r.cor r.drop    mean      sd
radius_mean         569  0.97  0.94  0.94   0.97  14.127   3.524
perimeter_mean      569  0.97  0.95  0.96   0.97  91.969  24.299
area_mean           569  0.98  0.96  0.96   0.96 654.889 351.914
concavity_mean      569  0.69  0.80  0.79   0.69   0.089   0.080
concave.points_mean 569  0.83  0.90  0.89   0.83   0.049   0.039
radius_se           569  0.77  0.85  0.85   0.77   0.405   0.277
perimeter_se        569  0.75  0.85  0.85   0.75   2.866   2.022
area_se             569  0.83  0.88  0.88   0.81  40.337  45.491
radius_worst        569  0.98  0.96  0.96   0.98  16.269   4.833
perimeter_worst     569  0.98  0.96  0.96   0.98 107.261  33.603
area_worst          569  0.99  0.96  0.96   0.97 880.583 569.357
~~~

~~~
psych::alpha(data2[,factor2])
~~~

~~~
Reliability analysis   
Call: psych::alpha(x = data2[, factor2])

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean    sd median_r
      0.82      0.93    0.97      0.57  13 0.0043 0.16 0.055     0.54

    95% confidence boundaries 
         lower alpha upper
Feldt     0.79  0.82  0.84
Duhachek  0.81  0.82  0.83

 Reliability if an item is dropped:
                        raw_alpha std.alpha G6(smc) average_r S/N
smoothness_mean              0.82      0.93    0.97      0.58  12
compactness_mean             0.78      0.92    0.96      0.55  11
symmetry_mean                0.81      0.93    0.97      0.59  13
fractal_dimension_mean       0.82      0.93    0.97      0.60  13
smoothness_worst             0.81      0.92    0.97      0.58  12
compactness_worst            0.74      0.92    0.96      0.55  11
concavity_worst              0.80      0.92    0.97      0.56  12
concave.points_worst         0.77      0.92    0.97      0.57  12
symmetry_worst               0.79      0.93    0.97      0.59  13
fractal_dimension_worst      0.81      0.92    0.96      0.56  12
                        alpha se var.r med.r
smoothness_mean           0.0043 0.028  0.54
compactness_mean          0.0050 0.025  0.51
symmetry_mean             0.0041 0.028  0.56
fractal_dimension_mean    0.0043 0.022  0.55
smoothness_worst          0.0043 0.029  0.54
compactness_worst         0.0075 0.022  0.53
concavity_worst           0.0057 0.022  0.54
concave.points_worst      0.0054 0.021  0.55
symmetry_worst            0.0041 0.028  0.56
fractal_dimension_worst   0.0045 0.028  0.53

 Item statistics 
                          n raw.r std.r r.cor r.drop  mean     sd
smoothness_mean         569  0.58  0.75  0.74   0.56 0.096 0.0141
compactness_mean        569  0.90  0.90  0.91   0.88 0.104 0.0528
symmetry_mean           569  0.59  0.71  0.68   0.55 0.181 0.0274
fractal_dimension_mean  569  0.47  0.66  0.66   0.46 0.063 0.0071
smoothness_worst        569  0.64  0.77  0.75   0.62 0.132 0.0228
compactness_worst       569  0.96  0.89  0.89   0.92 0.254 0.1573
concavity_worst         569  0.95  0.83  0.82   0.88 0.272 0.2086
concave.points_worst    569  0.88  0.78  0.78   0.85 0.115 0.0657
symmetry_worst          569  0.68  0.72  0.69   0.62 0.290 0.0619
fractal_dimension_worst 569  0.78  0.84  0.83   0.76 0.084 0.0181
~~~

~~~
psych::alpha(data2[,factor3])
~~~

~~~
Reliability analysis   
Call: psych::alpha(x = data2[, factor3])

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean    sd median_r
     0.073      0.85    0.87      0.45 5.6 0.0088 0.19 0.082     0.39

    95% confidence boundaries 
         lower alpha upper
Feldt    -0.05  0.07  0.19
Duhachek  0.06  0.07  0.09

 Reliability if an item is dropped:
                     raw_alpha std.alpha G6(smc) average_r S/N
texture_se               0.712      0.86    0.88      0.51 6.2
smoothness_se            0.070      0.85    0.87      0.48 5.5
compactness_se           0.055      0.80    0.82      0.40 4.1
concavity_se             0.047      0.81    0.83      0.42 4.3
concave.points_se        0.068      0.82    0.84      0.42 4.4
symmetry_se              0.061      0.85    0.87      0.48 5.5
fractal_dimension_se     0.072      0.81    0.83      0.41 4.2
                     alpha se var.r med.r
texture_se             0.0084 0.043  0.41
smoothness_se          0.0089 0.055  0.39
compactness_se         0.0067 0.030  0.37
concavity_se           0.0049 0.029  0.39
concave.points_se      0.0083 0.038  0.39
symmetry_se            0.0087 0.056  0.40
fractal_dimension_se   0.0087 0.040  0.34

 Item statistics 
                       n raw.r std.r r.cor r.drop   mean     sd
texture_se           569  1.00  0.54  0.42   0.29 1.2169 0.5516
smoothness_se        569  0.43  0.63  0.53   0.42 0.0070 0.0030
compactness_se       569  0.32  0.85  0.86   0.29 0.0255 0.0179
concavity_se         569  0.28  0.80  0.80   0.23 0.0319 0.0302
concave.points_se    569  0.31  0.79  0.77   0.30 0.0118 0.0062
symmetry_se          569  0.45  0.63  0.53   0.44 0.0205 0.0083
fractal_dimension_se 569  0.35  0.83  0.83   0.35 0.0038 0.0026
~~~

~~~
psych::alpha(data2[,factor4])
~~~

~~~
Reliability analysis   
Call: psych::alpha(x = data2[, factor4])

  raw_alpha std.alpha G6(smc) average_r S/N    ase mean  sd median_r
      0.92      0.95    0.91      0.91  21 0.0048   22 5.1     0.91

    95% confidence boundaries 
         lower alpha upper
Feldt     0.91  0.92  0.93
Duhachek  0.91  0.92  0.93

 Reliability if an item is dropped:
              raw_alpha std.alpha G6(smc) average_r S/N alpha se
texture_mean       0.64      0.91    0.83      0.91  10       NA
texture_worst      1.30      0.91    0.83      0.91  10       NA
              var.r med.r
texture_mean      0  0.91
texture_worst     0  0.91

 Item statistics 
                n raw.r std.r r.cor r.drop mean  sd
texture_mean  569  0.97  0.98  0.93   0.91   19 4.3
texture_worst 569  0.99  0.98  0.93   0.91   26 6.1
~~~

raw alphas for the factors are 0.62, 0.82, 0.073, and 0.92.

**Regression analysis using the factor scores as the independent variable**

Let's leave the interpretation of the factors and their current names as they are right now and combine the dependent variable and the factor scores into a dataset.

~~~
regression_data<-as.data.frame(cbind(data[,1],fit2$scores))
names(regression_data)<-c("diagnosis","MR1","MR2","MR3","MR4")
head(regression_data,10)
~~~

~~~
   diagnosis        MR1        MR2         MR3         MR4
1          0  1.5510956  2.6944295  0.85259043 -2.61653645
2          0  1.5898317 -0.2039978 -1.32951434 -0.65710852
3          0  1.4789655  0.5991823  0.33485479 -0.72549287
4          0 -0.9551380  4.3936242  1.96571657 -1.34862841
5          0  1.9338890 -0.3391737  0.32883501 -1.60496470
6          0 -0.5899714  2.3073353 -0.33374577 -0.71148709
7          0  1.1729122  0.4180209 -1.59902418 -0.29492231
8          0 -0.1557846  1.1312995  0.35477066 -0.09414853
9          0 -0.5841597  2.1731894  0.01243859  0.38162825
10         0 -1.8461453  4.4047723  0.19562650  2.95004645
~~~

divide the data into training and test sets before performing any analysis.

~~~
##make it reproducible
set.seed(113)
#use 80% of dataset as training set and 20% as test set
sample <- sample(c(TRUE, FALSE), nrow(regression_data), replace=TRUE, prob=c(0.8,0.2))
train.data <- regression_data[sample, ]
test.data <- regression_data[!sample, ]
~~~

**using variables to investigate trends**

the relationship between diagnosis and MR1

~~~
ggplot(train.data,aes(y=diagnosis,x=MR1))+
  geom_smooth(method="loess")+
  geom_smooth(method = "lm",col="red")+
  ggtitle("Relationship between diagnosis and MR1")
~~~

![plot1](https://user-images.githubusercontent.com/41892582/231527108-421d572e-d8fd-4d79-83d7-cd076bf15714.jpg)

the relationship between diagnosis and MR2

~~~
ggplot(train.data,aes(y=diagnosis,x=MR2))+
  geom_smooth(method="loess")+
  geom_smooth(method = "lm",col="red")+
  ggtitle("Relationship between diagnosis and MR2")
~~~

![plot2](https://user-images.githubusercontent.com/41892582/231527121-9c98a975-9c31-4424-aab5-1f78b068ffb2.jpg)

the relationship between diagnosis and MR3

~~~
ggplot(train.data,aes(y=diagnosis,x=MR3))+
  geom_smooth(method="loess")+
  geom_smooth(method = "lm",col="red")+
  ggtitle("Relationship between diagnosis and MR3")
~~~

![plot3](https://user-images.githubusercontent.com/41892582/231527021-0ba8690f-43c6-41b9-917c-1231872c54b7.jpg)

the relationship between diagnosis and MR4

~~~
ggplot(train.data,aes(y=diagnosis,x=MR4))+
  geom_smooth(method="loess")+
  geom_smooth(method = "lm",col="red")+
  ggtitle("Relationship between diagnosis and MR4")
~~~

![plot4](https://user-images.githubusercontent.com/41892582/231527042-2b617df7-9e78-48fc-b428-c985b3cabd55.jpg)

# Model Fitting

**Multiple logistic regression model using all the data**

~~~
model1<-lm(diagnosis~.,data = train.data)
summary(model1)
~~~

~~~
Call:
lm(formula = diagnosis ~ ., data = train.data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.03119 -0.16144  0.03571  0.17257  0.70840 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.62937    0.01223  51.453   <2e-16 ***
MR1         -0.33372    0.01267 -26.341   <2e-16 ***
MR2         -0.21139    0.01213 -17.430   <2e-16 ***
MR3          0.02543    0.01257   2.022   0.0437 *  
MR4         -0.10103    0.01139  -8.874   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2599 on 447 degrees of freedom
Multiple R-squared:  0.7117,	Adjusted R-squared:  0.7091 
F-statistic: 275.9 on 4 and 447 DF,  p-value: < 2.2e-16
~~~

all four independent variables are significant in the model.

using the model to predict the quality from the testing data and compare it with the real data

~~~
##apply the model to the test data
test1<-predict(model1,test.data)   
##convert the probability value to good or bad.
test1<-ifelse(test1>0.5,1,0)          
##compare the model's output to the actual data
confusionMatrix(table(test1,test.data$diagnosis))
~~~

~~~
Confusion Matrix and Statistics

     
test1  0  1
    0 39  1
    1  8 69
                                         
               Accuracy : 0.9231         
                 95% CI : (0.859, 0.9642)
    No Information Rate : 0.5983         
    P-Value [Acc > NIR] : 2.064e-15      
                                         
                  Kappa : 0.836          
                                         
 Mcnemar's Test P-Value : 0.0455         
                                         
            Sensitivity : 0.8298         
            Specificity : 0.9857         
         Pos Pred Value : 0.9750         
         Neg Pred Value : 0.8961         
             Prevalence : 0.4017         
         Detection Rate : 0.3333         
   Detection Prevalence : 0.3419         
      Balanced Accuracy : 0.9078         
                                         
       'Positive' Class : 0              
                               
~~~

**polynomial regression model**

In order to develop a polynomial regression model, we will add higher dimensional variables using the plots from the "Using Variables to Investigate Trends" section.

~~~
model2<-glm(diagnosis~poly(MR1,3)+
              poly(MR2,3)+
              poly(MR3,3)+
              poly(MR4,3),data = train.data)

summary(model2)
~~~

~~~
Call:
glm(formula = diagnosis ~ poly(MR1, 3) + poly(MR2, 3) + poly(MR3, 
    3) + poly(MR4, 3), data = train.data)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.87508  -0.14804   0.03067   0.16442   0.86574  

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)    0.63496    0.01164  54.551  < 2e-16 ***
poly(MR1, 3)1 -6.70149    0.27047 -24.777  < 2e-16 ***
poly(MR1, 3)2  1.77908    0.28600   6.221 1.16e-09 ***
poly(MR1, 3)3  0.74915    0.32234   2.324  0.02057 *  
poly(MR2, 3)1 -4.29228    0.26544 -16.171  < 2e-16 ***
poly(MR2, 3)2 -1.09972    0.27607  -3.983 7.95e-05 ***
poly(MR2, 3)3  0.87506    0.32730   2.674  0.00778 ** 
poly(MR3, 3)1  0.38149    0.27425   1.391  0.16491    
poly(MR3, 3)2  0.08731    0.25807   0.338  0.73527    
poly(MR3, 3)3  0.04733    0.25521   0.185  0.85297    
poly(MR4, 3)1 -2.14953    0.25342  -8.482 3.41e-16 ***
poly(MR4, 3)2  0.49229    0.25358   1.941  0.05285 .  
poly(MR4, 3)3  0.42589    0.25248   1.687  0.09234 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.06123707)

    Null deviance: 104.768  on 451  degrees of freedom
Residual deviance:  26.883  on 439  degrees of freedom
AIC: 35.093

Number of Fisher Scoring iterations: 2
~~~

~~~
##apply the model to the test data
test2<-predict(model2,test.data)   
##convert the probability value to good or bad.
test2<-ifelse(test2>0.5,1,0)          
##compare the model's output to the actual data
confusionMatrix(table(test2,test.data$diagnosis)) 
~~~

~~~
Confusion Matrix and Statistics

     
test2  0  1
    0 41  1
    1  6 69
                                          
               Accuracy : 0.9402          
                 95% CI : (0.8806, 0.9756)
    No Information Rate : 0.5983          
    P-Value [Acc > NIR] : <2e-16          
                                          
                  Kappa : 0.8733          
                                          
 Mcnemar's Test P-Value : 0.1306          
                                          
            Sensitivity : 0.8723          
            Specificity : 0.9857          
         Pos Pred Value : 0.9762          
         Neg Pred Value : 0.9200          
             Prevalence : 0.4017          
         Detection Rate : 0.3504          
   Detection Prevalence : 0.3590          
      Balanced Accuracy : 0.9290          
                                          
       'Positive' Class : 0               
                            
~~~

**Spline Regression**

We'll examine whether or not adding splines to the polynomial model will make it better.

~~~
model3<-glm(diagnosis~ns(MR1,3)+
              ns(MR2,3)+
              ns(MR3,3)+
              ns(MR4,3),data = train.data)
	      
summary(model3)	      
~~~

~~~
Call:
glm(formula = diagnosis ~ ns(MR1, 3) + ns(MR2, 3) + ns(MR3, 3) + 
    ns(MR4, 3), data = train.data)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-0.83189  -0.12686   0.02053   0.14078   0.75289  

Coefficients:
             Estimate Std. Error t value Pr(>|t|)    
(Intercept)  0.986022   0.242766   4.062 5.77e-05 ***
ns(MR1, 3)1 -1.479206   0.076159 -19.423  < 2e-16 ***
ns(MR1, 3)2 -0.925606   0.232491  -3.981 8.02e-05 ***
ns(MR1, 3)3 -0.766105   0.211270  -3.626 0.000321 ***
ns(MR2, 3)1 -0.307027   0.091286  -3.363 0.000837 ***
ns(MR2, 3)2 -0.039234   0.366226  -0.107 0.914735    
ns(MR2, 3)3 -0.989922   0.148619  -6.661 8.17e-11 ***
ns(MR3, 3)1 -0.007964   0.061541  -0.129 0.897087    
ns(MR3, 3)2  0.251780   0.161448   1.560 0.119597    
ns(MR3, 3)3  0.269994   0.113834   2.372 0.018131 *  
ns(MR4, 3)1 -0.392209   0.056870  -6.897 1.86e-11 ***
ns(MR4, 3)2 -0.633619   0.187658  -3.376 0.000800 ***
ns(MR4, 3)3 -0.366258   0.102612  -3.569 0.000397 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for gaussian family taken to be 0.05683926)

    Null deviance: 104.768  on 451  degrees of freedom
Residual deviance:  24.952  on 439  degrees of freedom
AIC: 1.4072

Number of Fisher Scoring iterations: 2
~~~
~~~
##apply the model to the test data
test3<-predict(model3,test.data)   
##convert the probability value to good or bad.
test3<-ifelse(test3>0.5,1,0)          
##compare the model's output to the actual data
confusionMatrix(table(test3,test.data$diagnosis))
~~~

~~~
Confusion Matrix and Statistics

     
test3  0  1
    0 41  0
    1  6 70
                                         
               Accuracy : 0.9487         
                 95% CI : (0.8917, 0.981)
    No Information Rate : 0.5983         
    P-Value [Acc > NIR] : < 2e-16        
                                         
                  Kappa : 0.891          
                                         
 Mcnemar's Test P-Value : 0.04123        
                                         
            Sensitivity : 0.8723         
            Specificity : 1.0000         
         Pos Pred Value : 1.0000         
         Neg Pred Value : 0.9211         
             Prevalence : 0.4017         
         Detection Rate : 0.3504         
   Detection Prevalence : 0.3504         
      Balanced Accuracy : 0.9362         
                                         
       'Positive' Class : 0   
~~~

**Regression tree**

~~~
dt<-rpart(diagnosis~.,data =train.data)
##the plot of the decision tree model
rpart.plot(dt)
~~~

![dt](https://user-images.githubusercontent.com/41892582/231537119-80d46417-3053-4883-88f9-999f4b27275e.jpg)

~~~
##apply the model to the test data
test4<-predict(dt,test.data)   
##convert the probability value to good or bad.
test4<-ifelse(test4>0.5,1,0)          
##compare the model's output to the actual data
confusionMatrix(table(test4,test.data$diagnosis))
~~~

~~~
Confusion Matrix and Statistics

     
test4  0  1
    0 44  7
    1  3 63
                                          
               Accuracy : 0.9145          
                 95% CI : (0.8484, 0.9583)
    No Information Rate : 0.5983          
    P-Value [Acc > NIR] : 1.522e-14       
                                          
                  Kappa : 0.8246          
                                          
 Mcnemar's Test P-Value : 0.3428          
                                          
            Sensitivity : 0.9362          
            Specificity : 0.9000          
         Pos Pred Value : 0.8627          
         Neg Pred Value : 0.9545          
             Prevalence : 0.4017          
         Detection Rate : 0.3761          
   Detection Prevalence : 0.4359          
      Balanced Accuracy : 0.9181          
                                          
       'Positive' Class : 0               
                             
~~~

**The results**

Through the use of our spline regression model, we can achieve 95% accuracy, 87% sensitivity, and 100% specificity. (the best that we get).
